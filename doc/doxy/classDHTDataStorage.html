<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OverSim: DHTDataStorage Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a>  </div>
  <div class="headertitle">
<h1>DHTDataStorage Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="DHTDataStorage" -->
<p><code>#include &lt;<a class="el" href="DHTDataStorage_8h_source.html">DHTDataStorage.h</a>&gt;</code></p>

<p><a href="classDHTDataStorage-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a813e2f92a57ef11b555edfb0fd9f08ca">numInitStages</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a5dccef194e54caa97f44171a9d92764c">initialize</a> (int stage)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a9954778320a14e7c31e6ac6e2a0aea5e">handleMessage</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual uint32_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#aa1cdb30a1524923e95af88540f84d00e">getSize</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns number of stored data items in the map.  <a href="#aa1cdb30a1524923e95af88540f84d00e"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a8b9558b53b6c7d64aa82bed6662a74b2">clear</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Clears all stored data items.  <a href="#a8b9558b53b6c7d64aa82bed6662a74b2"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structDhtDataEntry.html">DhtDataEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a59ed0b3b3970dbf1057636f4c7cb2c17">getDataEntry</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key, uint32_t kind, uint32_t id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a pointer to the requested stored data item.  <a href="#a59ed0b3b3970dbf1057636f4c7cb2c17"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="DHTDataStorage_8h.html#a2f8220ffa02a044fe8f817f5f9a29f36">DhtDataVector</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a1f1c6efad65db834501267855992f90b">getDataVector</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key, uint32_t kind=0, uint32_t id=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the stored data items with a given key, kind and id.  <a href="#a1f1c6efad65db834501267855992f90b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#aa99008f59fd5b3beb8f2cfccfaf54fc3">getSourceNode</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key, uint32_t kind, uint32_t id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns the source node of a stored data item with a given key.  <a href="#aa99008f59fd5b3beb8f2cfccfaf54fc3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a4ddcc8ac2516fc7db403fd4a27069a75">isModifiable</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key, uint32_t kind, uint32_t id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns a boolean telling if this data if modifiable.  <a href="#a4ddcc8ac2516fc7db403fd4a27069a75"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const DhtDataMap::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a9a5546debdaa4522c63b0b7e0a92545a">begin</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns an iterator to the beginning of the map.  <a href="#a9a5546debdaa4522c63b0b7e0a92545a"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const DhtDataMap::iterator&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#ab874e8a9c0ee339ff20eda9a6226de8f">end</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Returns an iterator to the end of the map.  <a href="#ab874e8a9c0ee339ff20eda9a6226de8f"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="structDhtDataEntry.html">DhtDataEntry</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a1fab63fa3bb75248a4118fdbb50c95f5">addData</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key, uint32_t kind, uint32_t id, <a class="el" href="classBinaryValue.html">BinaryValue</a> value, cMessage *ttlMessage, bool is_modifiable=true, <a class="el" href="classNodeHandle.html">NodeHandle</a> sourceNode=<a class="el" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6">NodeHandle::UNSPECIFIED_NODE</a>, bool responsible=true)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Store a new data item in the map.  <a href="#a1fab63fa3bb75248a4118fdbb50c95f5"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#af64b6e6563f5934443182986ab7b9f63">removeData</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key, uint32_t kind, uint32_t id)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes a certain data item from the map.  <a href="#af64b6e6563f5934443182986ab7b9f63"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#acf367beb54ac48b556fdb37504ff58b6">display</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="DHTDataStorage_8h.html#ae1791efbd50a05f79354e7b6444044ff">DhtDumpVector</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#ab8425aa4123fc352970c78f1890c08c4">dumpDht</a> (const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;key=<a class="el" href="classOverlayKey.html#ac0d4135dff2985e3582fdbed2a37eb75">OverlayKey::UNSPECIFIED_KEY</a>, uint32_t kind=0, uint32_t id=0)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Dump filtered local data records into a vector.  <a href="#ab8425aa4123fc352970c78f1890c08c4"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a97e3f0ca6983d2fae45d025d1971a377">updateDisplayString</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Displays the current number of successors in the list.  <a href="#a97e3f0ca6983d2fae45d025d1971a377"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#a959768d929f6cebe0400c1c3d1d9c142">updateTooltip</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Displays the first 4 successor nodes as tooltip.  <a href="#a959768d929f6cebe0400c1c3d1d9c142"></a><br/></td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="DHTDataStorage_8h.html#aae5fb8352785773186f9d4f082a35d01">DhtDataMap</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101">dataMap</a></td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">internal representation of the data storage  <a href="#ad3d37f6c611130ed9f12a4e6b3a6a101"></a><br/></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="DHTDataStorage_8h_source.html#l00068">68</a> of file <a class="el" href="DHTDataStorage_8h_source.html">DHTDataStorage.h</a>.</p>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="a1fab63fa3bb75248a4118fdbb50c95f5"></a><!-- doxytag: member="DHTDataStorage::addData" ref="a1fab63fa3bb75248a4118fdbb50c95f5" args="(const OverlayKey &amp;key, uint32_t kind, uint32_t id, BinaryValue value, cMessage *ttlMessage, bool is_modifiable=true, NodeHandle sourceNode=NodeHandle::UNSPECIFIED_NODE, bool responsible=true)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDhtDataEntry.html">DhtDataEntry</a> * DHTDataStorage::addData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>kind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classBinaryValue.html">BinaryValue</a>&nbsp;</td>
          <td class="paramname"> <em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>ttlMessage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>is_modifiable</em> = <code>true</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classNodeHandle.html">NodeHandle</a>&nbsp;</td>
          <td class="paramname"> <em>sourceNode</em> = <code><a class="el" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6">NodeHandle::UNSPECIFIED_NODE</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&nbsp;</td>
          <td class="paramname"> <em>responsible</em> = <code>true</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Store a new data item in the map. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>The key of the data item to be stored </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kind</em>&nbsp;</td><td>The kind of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>A random integer to identify multiple items with same key and kind </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>value</em>&nbsp;</td><td>The value of the data item to be stored </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>ttlMessage</em>&nbsp;</td><td>The self-message sent for the ttl expiration </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>is_modifiable</em>&nbsp;</td><td>Flag that tell if the data can be change by anyone, or just by the sourceNode </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>sourceNode</em>&nbsp;</td><td>Node which asked to store the value </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>responsible</em>&nbsp;</td><td></td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00155">155</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="DHT_8cc_source.html#l00292">DHT::handlePutRequest()</a>, and <a class="el" href="CBR-DHT_8cc_source.html#l00274">CBRDHT::handlePutRequest()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="structDhtDataEntry.html">DhtDataEntry</a> entry;
    entry.<a class="code" href="structDhtDataEntry.html#a6f3be99f7b0cdcd215a4ccb813e9f703">kind</a> = kind;
    entry.<a class="code" href="structDhtDataEntry.html#af40de9c1b7d6b4e1136ca6f2b9144a14">id</a> = id;
    entry.<a class="code" href="structDhtDataEntry.html#abffbe314f97ae10a9ca461e18102d618">value</a> = value;
    entry.<a class="code" href="structDhtDataEntry.html#af91eb3436a52ad0c6f424047113beee9">ttlMessage</a> = ttlMessage;
    entry.<a class="code" href="structDhtDataEntry.html#aad1c23be20c2eca392adc791dffabdcd">sourceNode</a> = sourceNode;
    entry.<a class="code" href="structDhtDataEntry.html#a67c185200bbf51575e08bb8f5f646d42">is_modifiable</a> = is_modifiable;
    entry.<a class="code" href="structDhtDataEntry.html#a6fb8dca58f59421a7c02e830d42b7e6f">responsible</a> = responsible;

    <span class="keywordflow">if</span> ((kind == 0) || (<span class="keywordtype">id</span> == 0)) {
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;DHTDataStorage::addData(): &quot;</span>
                            <span class="stringliteral">&quot;Not allowed to add data with kind = 0 or id = 0!&quot;</span>);
    }

    pair&lt;DhtDataMap::iterator, DhtDataMap::iterator&gt; pos =
        <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.equal_range(key);

    <span class="comment">// insert new record in sorted multimap (order: key, kind, id)</span>
    <span class="keywordflow">while</span> ((pos.first != pos.second) &amp;&amp; (pos.first-&gt;second.kind &lt; kind)) {
        ++pos.first;
    }

    <span class="keywordflow">while</span> ((pos.first != pos.second) &amp;&amp; (pos.first-&gt;second.kind == kind)
            &amp;&amp; (pos.first-&gt;second.id &lt; <span class="keywordtype">id</span>)) {
        ++pos.first;
    }

    <span class="keywordflow">return</span> &amp;(<a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.insert(pos.first, make_pair(key, entry))-&gt;second);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9a5546debdaa4522c63b0b7e0a92545a"></a><!-- doxytag: member="DHTDataStorage::begin" ref="a9a5546debdaa4522c63b0b7e0a92545a" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const DhtDataMap::iterator DHTDataStorage::begin </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns an iterator to the beginning of the map. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>An iterator </dd></dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00145">145</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="DHT_8cc_source.html#l00695">DHT::update()</a>, and <a class="el" href="CBR-DHT_8cc_source.html#l00668">CBRDHT::update()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.begin();
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a8b9558b53b6c7d64aa82bed6662a74b2"></a><!-- doxytag: member="DHTDataStorage::clear" ref="a8b9558b53b6c7d64aa82bed6662a74b2" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHTDataStorage::clear </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Clears all stored data items. </p>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00067">67</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="CBR-DHT_8cc_source.html#l00043">CBRDHT::~CBRDHT()</a>, and <a class="el" href="DHT_8cc_source.html#l00041">DHT::~DHT()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    map&lt;OverlayKey, DhtDataEntry&gt;::iterator iter;

    <span class="keywordflow">for</span>( iter = <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.begin(); iter != <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.end(); iter++ ) {
        cancelAndDelete(iter-&gt;second.ttlMessage);
    }

    <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.clear();
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="acf367beb54ac48b556fdb37504ff58b6"></a><!-- doxytag: member="DHTDataStorage::display" ref="acf367beb54ac48b556fdb37504ff58b6" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHTDataStorage::display </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00284">284</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    cout &lt;&lt; <span class="stringliteral">&quot;Content of DHTDataStorage:&quot;</span> &lt;&lt; endl;
    <span class="keywordflow">for</span> (DhtDataMap::iterator it = <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.begin();
         it != <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.end(); it++) {
        cout &lt;&lt; <span class="stringliteral">&quot;Key: &quot;</span> &lt;&lt; it-&gt;first &lt;&lt; <span class="stringliteral">&quot; Kind: &quot;</span> &lt;&lt; it-&gt;second.kind
             &lt;&lt; <span class="stringliteral">&quot; ID: &quot;</span> &lt;&lt; it-&gt;second.id &lt;&lt; <span class="stringliteral">&quot; Value: &quot;</span>
             &lt;&lt; it-&gt;second.value &lt;&lt; <span class="stringliteral">&quot;End-time: &quot;</span>
             &lt;&lt; it-&gt;second.ttlMessage-&gt;getArrivalTime() &lt;&lt; endl;
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab8425aa4123fc352970c78f1890c08c4"></a><!-- doxytag: member="DHTDataStorage::dumpDht" ref="ab8425aa4123fc352970c78f1890c08c4" args="(const OverlayKey &amp;key=OverlayKey::UNSPECIFIED_KEY, uint32_t kind=0, uint32_t id=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="DHTDataStorage_8h.html#ae1791efbd50a05f79354e7b6444044ff">DhtDumpVector</a> * DHTDataStorage::dumpDht </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em> = <code><a class="el" href="classOverlayKey.html#ac0d4135dff2985e3582fdbed2a37eb75">OverlayKey::UNSPECIFIED_KEY</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>kind</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>id</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Dump filtered local data records into a vector. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>The key of the data items to dump </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kind</em>&nbsp;</td><td>The kind of the data items to dump </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>The id of the data items to dump</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>the vector containing all matching data items </dd></dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00209">209</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="DHT_8cc_source.html#l00515">DHT::handleDumpDhtRequest()</a>, <a class="el" href="CBR-DHT_8cc_source.html#l00547">CBRDHT::handleDumpDhtRequest()</a>, and <a class="el" href="DHT_8cc_source.html#l00417">DHT::handleGetRequest()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="DHTDataStorage_8h.html#ae1791efbd50a05f79354e7b6444044ff">DhtDumpVector</a>* vect = <span class="keyword">new</span> <a class="code" href="DHTDataStorage_8h.html#ae1791efbd50a05f79354e7b6444044ff">DhtDumpVector</a>();
    <a class="code" href="classDhtDumpEntry.html" title="Class generated from common/CommonMessages.msg by opp_msgc.">DhtDumpEntry</a> entry;

    DhtDataMap::iterator iter, end;

    <span class="keywordflow">if</span> (key.<a class="code" href="classOverlayKey.html#abe357a4d1babcf7d30598a61cbc0f5c2" title="Returns true, if the key is unspecified.">isUnspecified</a>()) {
        iter = <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.begin();
        end = <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.end();
    } <span class="keywordflow">else</span> {
        iter = <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.lower_bound(key);
        end = <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.upper_bound(key);
    }

    <span class="keywordflow">for</span> (; iter != end; iter++) {
        <span class="keywordflow">if</span> (((kind == 0) || (iter-&gt;second.kind == kind)) &amp;&amp;
                ((<span class="keywordtype">id</span> == 0) || (iter-&gt;second.id == <span class="keywordtype">id</span>))) {

            entry.<a class="code" href="classDhtDumpEntry.html#a546225b26d85476b2d877893de847b05">setKey</a>(iter-&gt;first);
            entry.<a class="code" href="classDhtDumpEntry.html#ade6507473e9307ccca810260ca6c4205">setKind</a>(iter-&gt;second.kind);
            entry.<a class="code" href="classDhtDumpEntry.html#a6f455c7d3ce5a4e2f876bb223c786903">setId</a>(iter-&gt;second.id);
            entry.<a class="code" href="classDhtDumpEntry.html#aca88d206c10c4c9179a1e22ccb438592">setValue</a>(iter-&gt;second.value);
            entry.<a class="code" href="classDhtDumpEntry.html#ad674943354eefd2f9fa26d990204fe2e">setTtl</a>((<span class="keywordtype">int</span>)SIMTIME_DBL(
                        iter-&gt;second.ttlMessage-&gt;getArrivalTime() - simTime()));
            entry.<a class="code" href="classDhtDumpEntry.html#ae4e6240a9b98c061c00902de2b8e12a6">setOwnerNode</a>(iter-&gt;second.sourceNode);
            entry.<a class="code" href="classDhtDumpEntry.html#ac8776d2175615b88858eda8c154874b1">setIs_modifiable</a>(iter-&gt;second.is_modifiable);
            entry.<a class="code" href="classDhtDumpEntry.html#a3ebfae676ba06dc3520d8b739a620241">setResponsible</a>(iter-&gt;second.responsible);
            vect-&gt;push_back(entry);
        }
    }

    <span class="keywordflow">return</span> vect;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ab874e8a9c0ee339ff20eda9a6226de8f"></a><!-- doxytag: member="DHTDataStorage::end" ref="ab874e8a9c0ee339ff20eda9a6226de8f" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const DhtDataMap::iterator DHTDataStorage::end </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns an iterator to the end of the map. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>An iterator </dd></dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00150">150</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="DHT_8cc_source.html#l00695">DHT::update()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.end();
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a59ed0b3b3970dbf1057636f4c7cb2c17"></a><!-- doxytag: member="DHTDataStorage::getDataEntry" ref="a59ed0b3b3970dbf1057636f4c7cb2c17" args="(const OverlayKey &amp;key, uint32_t kind, uint32_t id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structDhtDataEntry.html">DhtDataEntry</a> * DHTDataStorage::getDataEntry </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>kind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns a pointer to the requested stored data item. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>The key of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kind</em>&nbsp;</td><td>The kind of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>A random integer to identify multiple items with same key and kind</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>pointer to the data item or NULL if data item is not available </dd></dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00084">84</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="DHTDataStorage_8cc_source.html#l00122">getSourceNode()</a>, <a class="el" href="CBR-DHT_8cc_source.html#l00331">CBRDHT::handleGetRequest()</a>, <a class="el" href="DHT_8cc_source.html#l00292">DHT::handlePutRequest()</a>, and <a class="el" href="DHTDataStorage_8cc_source.html#l00133">isModifiable()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    pair&lt;DhtDataMap::iterator, DhtDataMap::iterator&gt; pos =
        <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.equal_range(key);

    <span class="keywordflow">while</span> (pos.first != pos.second) {
        <span class="keywordflow">if</span> ((pos.first-&gt;second.kind == kind) &amp;&amp;
                (pos.first-&gt;second.id == <span class="keywordtype">id</span>)) {
            <span class="keywordflow">return</span> &amp;pos.first-&gt;second;
        }
        ++pos.first;
    }

    <span class="keywordflow">return</span> NULL;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a1f1c6efad65db834501267855992f90b"></a><!-- doxytag: member="DHTDataStorage::getDataVector" ref="a1f1c6efad65db834501267855992f90b" args="(const OverlayKey &amp;key, uint32_t kind=0, uint32_t id=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="DHTDataStorage_8h.html#a2f8220ffa02a044fe8f817f5f9a29f36">DhtDataVector</a> * DHTDataStorage::getDataVector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>kind</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>id</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the stored data items with a given key, kind and id. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>The key of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kind</em>&nbsp;</td><td>The kind of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>A random integer to identify multiple items with same key and kind</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The value of the data item with the given key </dd></dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00103">103</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="DHTDataStorage_8h.html#a2f8220ffa02a044fe8f817f5f9a29f36">DhtDataVector</a>* vect = <span class="keyword">new</span> <a class="code" href="DHTDataStorage_8h.html#a2f8220ffa02a044fe8f817f5f9a29f36">DhtDataVector</a>();
    <a class="code" href="structDhtDataEntry.html">DhtDataEntry</a> entry;

    pair&lt;DhtDataMap::iterator, DhtDataMap::iterator&gt; pos =
        <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.equal_range(key);

    <span class="keywordflow">while</span> (pos.first != pos.second) {
        entry = pos.first-&gt;second;
        vect-&gt;push_back(make_pair(key, entry));
        ++pos.first;
    }

    <span class="keywordflow">return</span> vect;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa1cdb30a1524923e95af88540f84d00e"></a><!-- doxytag: member="DHTDataStorage::getSize" ref="aa1cdb30a1524923e95af88540f84d00e" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t DHTDataStorage::getSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns number of stored data items in the map. </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>number of stored data items </dd></dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00079">79</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="CBR-DHT_8cc_source.html#l00668">CBRDHT::update()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.size();
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa99008f59fd5b3beb8f2cfccfaf54fc3"></a><!-- doxytag: member="DHTDataStorage::getSourceNode" ref="aa99008f59fd5b3beb8f2cfccfaf54fc3" args="(const OverlayKey &amp;key, uint32_t kind, uint32_t id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="classNodeHandle.html">NodeHandle</a> &amp; DHTDataStorage::getSourceNode </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>kind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns the source node of a stored data item with a given key. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>The key of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kind</em>&nbsp;</td><td>The kind of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>A random integer to identify multiple items with same key and kind</td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The source node of the data item with the given key </dd></dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00122">122</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="DHT_8cc_source.html#l00292">DHT::handlePutRequest()</a>, and <a class="el" href="CBR-DHT_8cc_source.html#l00274">CBRDHT::handlePutRequest()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="structDhtDataEntry.html">DhtDataEntry</a>* entry = <a class="code" href="classDHTDataStorage.html#a59ed0b3b3970dbf1057636f4c7cb2c17" title="Returns a pointer to the requested stored data item.">getDataEntry</a>(key, kind, <span class="keywordtype">id</span>);

    <span class="keywordflow">if</span> (entry == NULL)
        <span class="keywordflow">return</span> <a class="code" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6" title="the unspecified NodeHandle">NodeHandle::UNSPECIFIED_NODE</a>;
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span> entry-&gt;<a class="code" href="structDhtDataEntry.html#aad1c23be20c2eca392adc791dffabdcd">sourceNode</a>;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9954778320a14e7c31e6ac6e2a0aea5e"></a><!-- doxytag: member="DHTDataStorage::handleMessage" ref="a9954778320a14e7c31e6ac6e2a0aea5e" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHTDataStorage::handleMessage </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00062">62</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="yang_8cc.html#adb989392f8aada21b0f7ec2f7a41dc00">error</a>(<span class="stringliteral">&quot;This module doesn&#39;t handle messages!&quot;</span>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a5dccef194e54caa97f44171a9d92764c"></a><!-- doxytag: member="DHTDataStorage::initialize" ref="a5dccef194e54caa97f44171a9d92764c" args="(int stage)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHTDataStorage::initialize </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>stage</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00054">54</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (stage != <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532ad9afa81d0184c5f0649fa111f7a821bc" title="deprecated">MIN_STAGE_APP</a>)
        <span class="keywordflow">return</span>;

    <a class="code" href="hashWatch_8h.html#ac3751704303addd5d8f0a36286e70780" title="Makes std::multimaps inspectable in Tkenv.">WATCH_MULTIMAP</a>(<a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a4ddcc8ac2516fc7db403fd4a27069a75"></a><!-- doxytag: member="DHTDataStorage::isModifiable" ref="a4ddcc8ac2516fc7db403fd4a27069a75" args="(const OverlayKey &amp;key, uint32_t kind, uint32_t id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const bool DHTDataStorage::isModifiable </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>kind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Returns a boolean telling if this data if modifiable. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>The key of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kind</em>&nbsp;</td><td>The kind of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>A random integer to identify multiple items with same key and kind </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>The value of the is_modifiable value </dd></dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00133">133</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="DHT_8cc_source.html#l00292">DHT::handlePutRequest()</a>, and <a class="el" href="CBR-DHT_8cc_source.html#l00274">CBRDHT::handlePutRequest()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="structDhtDataEntry.html">DhtDataEntry</a>* entry = <a class="code" href="classDHTDataStorage.html#a59ed0b3b3970dbf1057636f4c7cb2c17" title="Returns a pointer to the requested stored data item.">getDataEntry</a>(key, kind, <span class="keywordtype">id</span>);

    <span class="keywordflow">if</span> (entry == NULL)
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    <span class="keywordflow">else</span>
        <span class="keywordflow">return</span> entry-&gt;<a class="code" href="structDhtDataEntry.html#a67c185200bbf51575e08bb8f5f646d42">is_modifiable</a>;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a813e2f92a57ef11b555edfb0fd9f08ca"></a><!-- doxytag: member="DHTDataStorage::numInitStages" ref="a813e2f92a57ef11b555edfb0fd9f08ca" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual int DHTDataStorage::numInitStages </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="DHTDataStorage_8h_source.html#l00072">72</a> of file <a class="el" href="DHTDataStorage_8h_source.html">DHTDataStorage.h</a>.</p>

<p><div class="fragment"><pre class="fragment">    {
        <span class="keywordflow">return</span> <a class="code" href="InitStages_8h.html#a42fde1aa1e14a1c45d29061d6e87e532a735021fae11712b786e515700dfdb5d1" title="deprecated">MAX_STAGE_APP</a> + 1;
    }
</pre></div></p>

</div>
</div>
<a class="anchor" id="af64b6e6563f5934443182986ab7b9f63"></a><!-- doxytag: member="DHTDataStorage::removeData" ref="af64b6e6563f5934443182986ab7b9f63" args="(const OverlayKey &amp;key, uint32_t kind, uint32_t id)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHTDataStorage::removeData </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>key</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>kind</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&nbsp;</td>
          <td class="paramname"> <em>id</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Removes a certain data item from the map. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>key</em>&nbsp;</td><td>The key of the data item to be removed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>kind</em>&nbsp;</td><td>The kind of the data item </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>id</em>&nbsp;</td><td>A random integer to identify multiple items with same key and kind </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00191">191</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p>Referenced by <a class="el" href="DHT_8cc_source.html#l00292">DHT::handlePutRequest()</a>, <a class="el" href="CBR-DHT_8cc_source.html#l00274">CBRDHT::handlePutRequest()</a>, <a class="el" href="DHT_8cc_source.html#l00088">DHT::handleTimerEvent()</a>, and <a class="el" href="CBR-DHT_8cc_source.html#l00109">CBRDHT::handleTimerEvent()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    pair&lt;DhtDataMap::iterator, DhtDataMap::iterator&gt; pos =
        <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.equal_range(key);

    <span class="keywordflow">while</span> (pos.first != pos.second) {

        <span class="keywordflow">if</span> (((kind == 0) || (pos.first-&gt;second.kind == kind)) &amp;&amp;
                ((<span class="keywordtype">id</span> == 0) || (pos.first-&gt;second.id == <span class="keywordtype">id</span>))) {
            cancelAndDelete(pos.first-&gt;second.ttlMessage);
            <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.erase(pos.first++);
        } <span class="keywordflow">else</span> {
            ++pos.first;
        }
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a97e3f0ca6983d2fae45d025d1971a377"></a><!-- doxytag: member="DHTDataStorage::updateDisplayString" ref="a97e3f0ca6983d2fae45d025d1971a377" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHTDataStorage::updateDisplayString </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Displays the current number of successors in the list. </p>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00247">247</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (ev.isGUI()) {
        <span class="keywordtype">char</span> buf[80];

        <span class="keywordflow">if</span> (<a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.size() == 1) {
            sprintf(buf, <span class="stringliteral">&quot;1 data item&quot;</span>);
        } <span class="keywordflow">else</span> {
            sprintf(buf, <span class="stringliteral">&quot;%zi data items&quot;</span>, <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.size());
        }

        getDisplayString().setTagArg(<span class="stringliteral">&quot;t&quot;</span>, 0, buf);
        getDisplayString().setTagArg(<span class="stringliteral">&quot;t&quot;</span>, 2, <span class="stringliteral">&quot;blue&quot;</span>);
    }

}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a959768d929f6cebe0400c1c3d1d9c142"></a><!-- doxytag: member="DHTDataStorage::updateTooltip" ref="a959768d929f6cebe0400c1c3d1d9c142" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DHTDataStorage::updateTooltip </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Displays the first 4 successor nodes as tooltip. </p>

<p>Definition at line <a class="el" href="DHTDataStorage_8cc_source.html#l00265">265</a> of file <a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">if</span> (ev.isGUI()) {
        std::stringstream str;

        <span class="keywordflow">for</span> (DhtDataMap::iterator it = <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.begin();
             it != <a class="code" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101" title="internal representation of the data storage">dataMap</a>.end(); it++) {
            str &lt;&lt; it-&gt;second.value;
        }

        str &lt;&lt; endl;

        <span class="keywordtype">char</span> buf[1024];
        sprintf(buf, <span class="stringliteral">&quot;%s&quot;</span>, str.str().c_str());
        getDisplayString().setTagArg(<span class="stringliteral">&quot;tt&quot;</span>, 0, buf);
    }
}
</pre></div></p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="ad3d37f6c611130ed9f12a4e6b3a6a101"></a><!-- doxytag: member="DHTDataStorage::dataMap" ref="ad3d37f6c611130ed9f12a4e6b3a6a101" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="DHTDataStorage_8h.html#aae5fb8352785773186f9d4f082a35d01">DhtDataMap</a> <a class="el" href="classDHTDataStorage.html#ad3d37f6c611130ed9f12a4e6b3a6a101">DHTDataStorage::dataMap</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>internal representation of the data storage </p>

<p>Definition at line <a class="el" href="DHTDataStorage_8h_source.html#l00199">199</a> of file <a class="el" href="DHTDataStorage_8h_source.html">DHTDataStorage.h</a>.</p>

<p>Referenced by <a class="el" href="DHTDataStorage_8cc_source.html#l00155">addData()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00145">begin()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00067">clear()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00284">display()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00209">dumpDht()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00150">end()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00084">getDataEntry()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00103">getDataVector()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00079">getSize()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00054">initialize()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00191">removeData()</a>, <a class="el" href="DHTDataStorage_8cc_source.html#l00247">updateDisplayString()</a>, and <a class="el" href="DHTDataStorage_8cc_source.html#l00265">updateTooltip()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="DHTDataStorage_8h_source.html">DHTDataStorage.h</a></li>
<li><a class="el" href="DHTDataStorage_8cc_source.html">DHTDataStorage.cc</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Nov 3 2010 14:40:49 for OverSim by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
