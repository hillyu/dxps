<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>OverSim: Nps Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li class="current"><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="annotated.html"><span>Class&nbsp;List</span></a></li>
      <li><a href="hierarchy.html"><span>Class&nbsp;Hierarchy</span></a></li>
      <li><a href="functions.html"><span>Class&nbsp;Members</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="#friends">Friends</a>  </div>
  <div class="headertitle">
<h1>Nps Class Reference</h1>  </div>
</div>
<div class="contents">
<!-- doxytag: class="Nps" --><!-- doxytag: inherits="RpcListener,AbstractNcs" -->
<p><code>#include &lt;<a class="el" href="Nps_8h_source.html">Nps.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Nps:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classNps.png" usemap="#Nps_map" alt=""/>
  <map id="Nps_map" name="Nps_map">
<area href="classRpcListener.html" alt="RpcListener" shape="rect" coords="0,0,81,24"/>
<area href="classAbstractNcs.html" alt="AbstractNcs" shape="rect" coords="91,0,172,24"/>
</map>
</div>

<p><a href="classNps-members.html">List of all members.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a95dfb2a94f3554b7ed99d9f9bb3a0195">Nps</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a3e6d73fa177dc950505a934a4e0c92c6">init</a> (<a class="el" href="classNeighborCache.html">NeighborCache</a> *<a class="el" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a2291e96c9b071a2110bcd2a36dec631e">handleTimerEvent</a> (cMessage *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#af65b7ba515df95cfb26de4ab7bdaf07f">handleRpcCall</a> (<a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="structProx.html">Prox</a>&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a75d836ef63e2622f55fa5c7524113068">getCoordinateBasedProx</a> (const <a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> &amp;info) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#aaeec7877761f56e11a0523e8823c09b7">getUnvalidNcsInfo</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a2096cd53969a1301c89b80690c38b824">createNcsInfo</a> (const std::vector&lt; double &gt; &amp;coords) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">virtual const <a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#acf6a58594d71c593f29f2b937d0340ae">getOwnNcsInfo</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const std::vector&lt; double &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#aea00852807177b7877c0850960e0bd14">getOwnCoordinates</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">double&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a537a106ab588ceeb1188e8e467df9e25">getOwnCoordinates</a> (uint8_t i) const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a2adba20baee99d4a34eaae6231e2a9c3">getOwnLayer</a> () const </td></tr>
<tr><td colspan="2"><h2><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a799b41ef71641415d9d4fef3170df782">computeOwnLayer</a> (const std::vector&lt; <a class="el" href="structLandmarkDataEntry.html">LandmarkDataEntry</a> &gt; &amp;landmarks)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">computes this node's NPS layer (max of reference points' layers + 1)  <a href="#a799b41ef71641415d9d4fef3170df782"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#aeae4d2bc15d44ef58080dbb0a792abd3">computeOwnCoordinates</a> (const std::vector&lt; <a class="el" href="structLandmarkDataEntry.html">LandmarkDataEntry</a> &gt; &amp;landmarks)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">methods for computing own coordinates with the received data  <a href="#aeae4d2bc15d44ef58080dbb0a792abd3"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#af18fa643b698f2fabe02d7c0be7ecf4b">setOwnLayer</a> (int8_t layer)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">announces node's NPS layer to Bootstrap Oracle and Neighbor Cache  <a href="#af18fa643b698f2fabe02d7c0be7ecf4b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a09bd43b58b11f180242a6c2feac49261">setOwnCoordinates</a> (const std::vector&lt; double &gt; &amp;coords)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a83407d363a852ab9dfc70f2aa10e058d">sendCoordRequests</a> ()</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><a class="el" href="classGet.html">Get</a> a random set of landmarks / NPS reference node and send coordinate requests to them.  <a href="#a83407d363a852ab9dfc70f2aa10e058d"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#ad62b1be7467dc7f6bf31dcbe021ebc1c">sendCoordRequests</a> (const std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; &amp;landmarks)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#ac3d69d35fad31b52f5fc039dcff01d6d">sendCoordsReqCall</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;dest, simtime_t timeout)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#aa1dd1d909f093a487b2a6b67fe37ca28">handleRpcResponse</a> (<a class="el" href="classBaseResponseMessage.html">BaseResponseMessage</a> *msg, cPolymorphic *context, int rpcId, simtime_t rtt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a2b19076c7801b2ca41b6b1e400571f9c">handleRpcTimeout</a> (<a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *msg, const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;dest, cPolymorphic *context, int rpcId, const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;destKey)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a27eb36ff406f9fe0d2fdb5f41a479ab5">coordsReqRpcResponse</a> (<a class="el" href="classCoordsReqResponse.html">CoordsReqResponse</a> *response, cPolymorphic *context, int rpcId, simtime_t rtt)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#ae2354ae4c693d9d4dc6e57de89c44790">coordsReqRpc</a> (<a class="el" href="classCoordsReqCall.html">CoordsReqCall</a> *msg)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structLandmarkDataEntry.html">LandmarkDataEntry</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#af27e095e68e6267c245bf308390e2bda">getLandmarkData</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a196455a5bbd7d13e32046d49491a4a1b">getLandmarks</a> (uint8_t howmany)</td></tr>
<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Askes <a class="el" href="classGlobalNodeList.html" title="Global module (formerly known as GlobalNodeList) that supports the node bootstrap process and contain...">GlobalNodeList</a> for appropriate landmark nodes.  <a href="#a196455a5bbd7d13e32046d49491a4a1b"></a><br/></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">const std::vector<br class="typebreak"/>
&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; &amp;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a844b41690ecd7c494b3f21f7e59c6edb">getLandmarkSet</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a3f9826cfa483983300c7de618b9f98a6">getLandmarkSetSize</a> () const </td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a9a402f06e7948d4c86dec35c529a08bc">setLandmarkSet</a> (uint8_t howManyLM, uint8_t <a class="el" href="classNps.html#ae3c83ca224d7cf2ab4e71cafacecfa07">maxLayer</a>, std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; *<a class="el" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">bool&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#af641f9c68efaa852a7afe2389706c305">enoughLandmarks</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a3714d1d15661715ae6d7b75e74d0968e">updateNodeMeasurement</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node, uint8_t pending=0, uint8_t sent=0, uint8_t passed=0)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a907d7e0eb33fdcadd97c141e47dc9bb2">deleteNodeMeasurement</a> (const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;node)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#abfc6be18674ec13546a90a587264f315">getReceivedCalls</a> () const </td></tr>
<tr><td colspan="2"><h2><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="structRttMeasurement.html">RttMeasurement</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a></td></tr>
<tr><td colspan="2"><h2><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classNeighborCache.html">NeighborCache</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classBaseOverlay.html">BaseOverlay</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a2fa1935935077a421a76979a613e4517">overlay</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGlobalNodeList.html">GlobalNodeList</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classCoordBasedRouting.html">CoordBasedRouting</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a2f2d88bdce6b96f3819bb1876dd3d785">coordBasedRouting</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#ae3c83ca224d7cf2ab4e71cafacecfa07">maxLayer</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">simtime_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a60317df69b6b5dc8d8095bae37891686">landmarkTimeout</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top"><a class="el" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a> *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#ac09a03018ddd419b62867c516974090a">pendingRequests</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint8_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a42ccd3f2efe12d99bdf6a1cae8771f38">coordCalcRuns</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt;&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint16_t&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a2ac887be6d5f1333cefc902be95ddfa7">receivedCalls</a></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">cMessage *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a69f19f64cd77c044e0f7b601d6ad6664">landmarkTimer</a></td></tr>
<tr><td colspan="2"><h2><a name="friends"></a>
Friends</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">class&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="classNps.html#a4aa06e10717f2124a0b37ccc3f4dc573">Landmark</a></td></tr>
</table>
<hr/><a name="_details"></a><h2>Detailed Description</h2>

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00076">76</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>
<hr/><h2>Constructor &amp; Destructor Documentation</h2>
<a class="anchor" id="a95dfb2a94f3554b7ed99d9f9bb3a0195"></a><!-- doxytag: member="Nps::Nps" ref="a95dfb2a94f3554b7ed99d9f9bb3a0195" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">Nps::Nps </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00102">102</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p><div class="fragment"><pre class="fragment">{};
</pre></div></p>

</div>
</div>
<hr/><h2>Member Function Documentation</h2>
<a class="anchor" id="aeae4d2bc15d44ef58080dbb0a792abd3"></a><!-- doxytag: member="Nps::computeOwnCoordinates" ref="aeae4d2bc15d44ef58080dbb0a792abd3" args="(const std::vector&lt; LandmarkDataEntry &gt; &amp;landmarks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::computeOwnCoordinates </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structLandmarkDataEntry.html">LandmarkDataEntry</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>landmarks</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>methods for computing own coordinates with the received data </p>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00495">495</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classCoordCalcFunction.html" title="Auxiliary class for coord calculation.">CoordCalcFunction</a> coordcalcf(landmarks);

    <a class="code" href="classVtr.html">Vec_DP</a> initCoordinates(<a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a>);
    <a class="code" href="classVtr.html">Vec_DP</a> bestCoordinates(<a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a>);
    std::vector&lt;double&gt; computedCoordinatesStdVector(<a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a>);

    <span class="keywordtype">double</span> bestval;
    <span class="keywordtype">double</span> resval;

    <span class="keywordflow">for</span> (uint runs = 0; runs &lt; <a class="code" href="classNps.html#a42ccd3f2efe12d99bdf6a1cae8771f38">coordCalcRuns</a>; runs++) {
        <span class="comment">// start with random coordinates (-100..100 in each dim)</span>
        <span class="keywordflow">for</span> (uint i = 0; i &lt; <a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a>; i++) {
            initCoordinates[i] = uniform(-100, 100);
        }
        <span class="comment">// compute minimum coordinates via Simplex-Downhill minimum</span>
        <span class="comment">// function value is returned, coords are written into initCoordinates</span>
        <span class="comment">// (call by reference)</span>
        resval = <a class="code" href="classCoordCalcFunction.html#a9d232ad0e0ca9a463fc97d34f799762b">CoordCalcFunction::simplex_min</a>(&amp;coordcalcf, initCoordinates);
        <span class="keywordflow">if</span> (runs == 0 || (runs &gt; 0 &amp;&amp; resval &lt; bestval) ) {
            bestval = resval;
            bestCoordinates = initCoordinates;
        }
    }

    <span class="keywordflow">for</span> (uint i = 0; i &lt; dimensions; i++) {
        computedCoordinatesStdVector[i] = bestCoordinates[i];
    }

    <a class="code" href="classNps.html#a09bd43b58b11f180242a6c2feac49261">setOwnCoordinates</a>(computedCoordinatesStdVector);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a799b41ef71641415d9d4fef3170df782"></a><!-- doxytag: member="Nps::computeOwnLayer" ref="a799b41ef71641415d9d4fef3170df782" args="(const std::vector&lt; LandmarkDataEntry &gt; &amp;landmarks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::computeOwnLayer </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="structLandmarkDataEntry.html">LandmarkDataEntry</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>landmarks</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>computes this node's NPS layer (max of reference points' layers + 1) </p>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00449">449</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    int8_t computedLayer = <a class="code" href="classNps.html#a2adba20baee99d4a34eaae6231e2a9c3">getOwnLayer</a>();
    <span class="keywordflow">for</span> (uint i = 0; i &lt; landmarks.size(); i++) {
        <span class="keywordflow">if</span> (computedLayer &lt;= landmarks[i].layer) {
            computedLayer = landmarks[i].layer + 1;
        }
    }
    <a class="code" href="classNps.html#af18fa643b698f2fabe02d7c0be7ecf4b" title="announces node&amp;#39;s NPS layer to Bootstrap Oracle and Neighbor Cache">setOwnLayer</a>(computedLayer);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ae2354ae4c693d9d4dc6e57de89c44790"></a><!-- doxytag: member="Nps::coordsReqRpc" ref="ae2354ae4c693d9d4dc6e57de89c44790" args="(CoordsReqCall *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::coordsReqRpc </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCoordsReqCall.html">CoordsReqCall</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00160">160</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00150">handleRpcCall()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classNps.html#a2ac887be6d5f1333cefc902be95ddfa7">receivedCalls</a>++;
    <a class="code" href="classCoordsReqResponse.html" title="Class generated from common/Nps.msg by opp_msgc.">CoordsReqResponse</a>* coordResp = <span class="keyword">new</span> <a class="code" href="classCoordsReqResponse.html" title="Class generated from common/Nps.msg by opp_msgc.">CoordsReqResponse</a>(<span class="stringliteral">&quot;CoordsReqResp&quot;</span>);
    coordResp-&gt;<a class="code" href="classCoordsReqResponse.html#a455dc0682da539a4408de2f3cf243ddf">setLayer</a>(<a class="code" href="classNps.html#a2adba20baee99d4a34eaae6231e2a9c3">getOwnLayer</a>()); <span class="comment">//TODO</span>
    coordResp-&gt;<a class="code" href="classBaseResponseMessage.html#a4f05dbcf7968e8a20ca74cd54c4590a8">setNcsInfoArraySize</a>(<a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a> + 1);

    <span class="comment">//if (getOwnLayer() != 0) {</span>
    <span class="comment">// ordinary node</span>

    <span class="keyword">const</span> std::vector&lt;double&gt;&amp; ownCoordinates = <a class="code" href="classNps.html#aea00852807177b7877c0850960e0bd14">getOwnCoordinates</a>();

    uint8_t i;
    <span class="keywordflow">for</span> (i = 0; i &lt; ownCoordinates.size(); ++i) {
        coordResp-&gt;<a class="code" href="classBaseResponseMessage.html#a2f3c21c0c29d2b72a0843596fd9871c7">setNcsInfo</a>(i, ownCoordinates[i]);
    }
    coordResp-&gt;<a class="code" href="classBaseResponseMessage.html#a2f3c21c0c29d2b72a0843596fd9871c7">setNcsInfo</a>(i, <a class="code" href="classNps.html#a2adba20baee99d4a34eaae6231e2a9c3">getOwnLayer</a>());

    <span class="comment">/*} else {</span>
<span class="comment">        // landmark node</span>
<span class="comment">        Landmark* landmark = check_and_cast&lt;Landmark*&gt;(neighborCache-&gt;getParentModule()</span>
<span class="comment">            -&gt;getModuleByRelativePath(&quot;tier1.landmark&quot;));</span>
<span class="comment">        assert(landmark);</span>
<span class="comment">        const std::vector&lt;double&gt;&amp; ownCoordinates = landmark-&gt;getOwnNpsCoords();</span>
<span class="comment"></span>
<span class="comment">        uint8_t i;</span>
<span class="comment">        for (i = 0; i &lt; ownCoordinates.size(); ++i) {</span>
<span class="comment">            coordResp-&gt;setNcsInfo(i, ownCoordinates[i]);</span>
<span class="comment">        }</span>
<span class="comment">        coordResp-&gt;setNcsInfo(i, getOwnLayer());</span>
<span class="comment">    }*/</span>

    coordResp-&gt;setBitLength(<a class="code" href="Nps__m_8h.html#ae7b4015cd07fa61cece5f394d6baf81e">COORDSREQRESPONSE_L</a>(coordResp));
    <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#adc06091d348c98a5efbf54fe0afe8747" title="Send Remote-Procedure response message and deletes call message.">sendRpcResponse</a>(msg, coordResp);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a27eb36ff406f9fe0d2fdb5f41a479ab5"></a><!-- doxytag: member="Nps::coordsReqRpcResponse" ref="a27eb36ff406f9fe0d2fdb5f41a479ab5" args="(CoordsReqResponse *response, cPolymorphic *context, int rpcId, simtime_t rtt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::coordsReqRpcResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classCoordsReqResponse.html">CoordsReqResponse</a> *&nbsp;</td>
          <td class="paramname"> <em>response</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&nbsp;</td>
          <td class="paramname"> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rpcId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&nbsp;</td>
          <td class="paramname"> <em>rtt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00207">207</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00087">handleRpcResponse()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classNps.html#ac09a03018ddd419b62867c516974090a">pendingRequests</a>--;
    <a class="code" href="classNodeHandle.html" title="This class implements a node handle.">NodeHandle</a>&amp; srcNode = response-&gt;<a class="code" href="classBaseRpcMessage.html#ada3e122125cfb5acc7350277ca69c45a">getSrcNode</a>();

    std::vector&lt;double&gt; tempCoords;
    <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; response-&gt;<a class="code" href="classBaseResponseMessage.html#a1a793c9078236fc7a397dd0688994c62">getNcsInfoArraySize</a>(); i++) {
        tempCoords.push_back(response-&gt;<a class="code" href="classBaseResponseMessage.html#a19f5158a6c4cf04297ad95ed754bdff8">getNcsInfo</a>(i));
    }
    <a class="code" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>* coordsInfo =
        <span class="keyword">static_cast&lt;</span><a class="code" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>*<span class="keyword">&gt;</span>(<a class="code" href="classNps.html#a2096cd53969a1301c89b80690c38b824">createNcsInfo</a>(tempCoords));

    EV &lt;&lt; <span class="stringliteral">&quot;[Nps::coordsReqRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
       &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n    received landmark coords: &quot;</span>
       &lt;&lt; tempCoords[0];

    <span class="keywordflow">for</span> (uint8_t i = 1; i &lt; <a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a>; i++) {
        EV &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; tempCoords[i];
    }
    EV  &lt;&lt; <span class="stringliteral">&quot; (rtt = &quot;</span> &lt;&lt; rtt &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; endl;

<span class="preprocessor">#ifdef EXTJOIN_DISCOVERY</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (doingDiscovery()) {
        <span class="comment">//if in Discovery insert RTT only if lower then already set RTT</span>
        <span class="keywordflow">if</span> ((isEntry(srcNode) &amp;&amp; rtt &lt; getNodeRtt(srcNode))
            || (isEntry(srcNode) &amp;&amp; getNodeRtt(srcNode) &lt; 0) ) {
            updateNode(srcNode, rtt, tempCoords, 0);
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!(isEntry(srcNode))) {
            updateNode(srcNode, rtt, tempCoords, 0);
        } <span class="keywordflow">else</span> {
            updateNode(srcNode, getNodeRtt(srcNode), tempCoords, 0);
        }
        setNodeLayer(srcNode, tempLayer);
    }
    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (doingNodeMeasurement()) {
        <span class="keywordflow">if</span> (getPendingRttsReq(srcNode) == -1) {
            updateNode(srcNode, rtt, tempCoords, 0);
            setNodeLayer(srcNode, tempLayer);
            <a class="code" href="classRttToNodeCall.html" title="Class generated from common/cbr/CoordMessages.msg by opp_msgc.">RttToNodeCall</a>* prevCall = getNodeMessage(srcNode);

            <a class="code" href="classRttToNodeResponse.html" title="Class generated from common/cbr/CoordMessages.msg by opp_msgc.">RttToNodeResponse</a>* rttRes = <span class="keyword">new</span> <a class="code" href="classRttToNodeResponse.html" title="Class generated from common/cbr/CoordMessages.msg by opp_msgc.">RttToNodeResponse</a>(<span class="stringliteral">&quot;RttToNodeXRes&quot;</span>);
            rttRes-&gt;<a class="code" href="classRttToNodeResponse.html#a3a54f20e65e557a9920de288a54bd4fa">setPingedNode</a>(srcNode);
            rttRes-&gt;<a class="code" href="classRttToNodeResponse.html#a83c2cb099597a80946be3ea5fb93c4d3">setRttToNode</a>(rtt);
            std::vector&lt;double&gt; tempOwnCoords;
            tempOwnCoords = <a class="code" href="classNps.html#aea00852807177b7877c0850960e0bd14">getOwnCoordinates</a>();
            rttRes-&gt;<a class="code" href="classRttToNodeResponse.html#a68c6f1ede76e28ed787224b0aaf885a7">setOwnCoordinatesArraySize</a>(tempOwnCoords.size());
            <span class="keywordflow">for</span> (uint i = 0; i &lt; tempOwnCoords.size(); i++) {
                rttRes-&gt;<a class="code" href="classRttToNodeResponse.html#acc575232367863a997435728427b58e3">setOwnCoordinates</a>(i, tempOwnCoords[i]);
            }

            sendRpcResponse(prevCall, rttRes);
            <a class="code" href="classNps.html#a907d7e0eb33fdcadd97c141e47dc9bb2">deleteNodeMeasurement</a>(srcNode);
        } <span class="keywordflow">else</span> {
            updateNode(srcNode, rtt, tempCoords, 0);
            setNodeLayer(srcNode, tempLayer);
            <span class="keywordflow">if</span> (checkCoordinates(<a class="code" href="classNps.html#aea00852807177b7877c0850960e0bd14">getOwnCoordinates</a>(), tempCoords, rtt)) {
                <a class="code" href="classNps.html#a3714d1d15661715ae6d7b75e74d0968e">updateNodeMeasurement</a>(srcNode, -1, 0, 1);
            } <span class="keywordflow">else</span> {
                <a class="code" href="classNps.html#a3714d1d15661715ae6d7b75e74d0968e">updateNodeMeasurement</a>(srcNode, -1, 0, 0);
            }
        }
    }
    <span class="keywordflow">else</span>
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <span class="keywordflow">if</span> (<a class="code" href="classNps.html#ac09a03018ddd419b62867c516974090a">pendingRequests</a> == 0) {
        <span class="comment">// got all responses, now compute own coordinates and join overlay</span>
        <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#a057e94a37705dfab0ab1f91417603450">updateNode</a>(srcNode, rtt, <a class="code" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6" title="the unspecified NodeHandle">NodeHandle::UNSPECIFIED_NODE</a>,
                                  coordsInfo);

        std::vector&lt;LandmarkDataEntry&gt; probedLandmarks;
        <span class="keywordflow">if</span> (<a class="code" href="classNps.html#a3f9826cfa483983300c7de618b9f98a6">getLandmarkSetSize</a>() &lt; dimensions + 1) {
            <a class="code" href="classNps.html#a9a402f06e7948d4c86dec35c529a08bc">setLandmarkSet</a>(dimensions + 1, <a class="code" href="classNps.html#ae3c83ca224d7cf2ab4e71cafacecfa07">maxLayer</a>, &amp;<a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>);
        }

        <span class="keywordflow">for</span> (std::vector&lt;TransportAddress&gt;::iterator it = <a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>.begin();
             it != <a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>.end(); ++it) {
            <span class="keyword">const</span> <a class="code" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>* tempInfo =
                <span class="keyword">dynamic_cast&lt;</span><span class="keyword">const </span><a class="code" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>*<span class="keyword">&gt;</span>(<a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#a5bfc95cec29a0c320e3586629fb85504" title="Returns the coordinate information of a node.">getNodeCoordsInfo</a>(*it));

            assert(tempInfo);

            <a class="code" href="structLandmarkDataEntry.html" title="Auxiliary struct that holds all data from a landmark that a node needs for its own coord computation...">LandmarkDataEntry</a> temp;
            temp.<a class="code" href="structLandmarkDataEntry.html#a29d9ff495b30857526efa7973f2e9f96">coordinates</a>.resize(tempInfo-&gt;<a class="code" href="classEuclideanNcsNodeInfo.html#a8bcc42e2b82fb93aead825acd61739ad">getDimension</a>());
            temp.<a class="code" href="structLandmarkDataEntry.html#ad5d601343f46d6e18a36bbb31828566e">rtt</a> = <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#ab94f734ab0667605962f2bb4f315e9f1">getNodeRtt</a>(*it).first;
            temp.<a class="code" href="structLandmarkDataEntry.html#a1cca78790ce843cd40639f3365326bcc">layer</a> = tempInfo-&gt;<a class="code" href="classGnpNpsCoordsInfo.html#aa79b0f19b890c91eb64d802b5bb23f0f">getLayer</a>();
            <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; tempInfo-&gt;<a class="code" href="classEuclideanNcsNodeInfo.html#a8bcc42e2b82fb93aead825acd61739ad">getDimension</a>(); ++i) {
                temp.<a class="code" href="structLandmarkDataEntry.html#a29d9ff495b30857526efa7973f2e9f96">coordinates</a>[i] = tempInfo-&gt;<a class="code" href="classEuclideanNcsNodeInfo.html#a43b66b96092e688a0e775b7c795f96c5">getCoords</a>(i);
            }
            temp.<a class="code" href="structLandmarkDataEntry.html#aac6d7ca064c48202149a6cee22f4c55b">ip</a> = NULL;

            probedLandmarks.push_back(temp);
        }
        assert(probedLandmarks.size() &gt; 0);

        <a class="code" href="classNps.html#aeae4d2bc15d44ef58080dbb0a792abd3" title="methods for computing own coordinates with the received data">computeOwnCoordinates</a>(probedLandmarks);
        <a class="code" href="classNps.html#a799b41ef71641415d9d4fef3170df782" title="computes this node&amp;#39;s NPS layer (max of reference points&amp;#39; layers + 1)">computeOwnLayer</a>(probedLandmarks);

        std::vector&lt;double&gt; coords = <a class="code" href="classNps.html#aea00852807177b7877c0850960e0bd14">getOwnCoordinates</a>();
        EV &lt;&lt; <span class="stringliteral">&quot;[Nps::coordsReqRpcResponse() @ &quot;</span> &lt;&lt; <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
           &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]\n    setting own coords: &quot;</span>
           &lt;&lt; coords[0];
        <span class="keywordflow">for</span> (uint8_t i = 1; i &lt; dimensions; i++) {
            EV &lt;&lt; <span class="stringliteral">&quot;, &quot;</span> &lt;&lt; coords[i];
        }
        EV &lt;&lt; endl;

        <span class="comment">//test</span>
        <span class="comment">/*</span>
<span class="comment">        ChurnGenerator* lmChurnGen = NULL;</span>
<span class="comment">        for (uint8_t i = 0; i &lt; neighborCache-&gt;underlayConfigurator-&gt;getChurnGeneratorNum(); i++) {</span>
<span class="comment">            ChurnGenerator* searchedGen;</span>
<span class="comment">            searchedGen = neighborCache-&gt;underlayConfigurator-&gt;getChurnGenerator(i);</span>
<span class="comment">            if (searchedGen-&gt;getNodeType().overlayType != &quot;oversim.common.cbr.LandmarkModules&quot;) {</span>
<span class="comment">                lmChurnGen = searchedGen;</span>
<span class="comment">            }</span>
<span class="comment">        }</span>
<span class="comment">        */</span>

        <a class="code" href="classSimpleNodeEntry.html" title="representation of a single node in the GlobalNodeList">SimpleNodeEntry</a>* entry =
                <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classSimpleInfo.html">SimpleInfo</a>*<span class="keyword">&gt;</span>(<a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a>-&gt;
                                          getPeerInfo(<a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()))-&gt;getEntry();

        <span class="keywordtype">double</span> <a class="code" href="yang_8cc.html#adb989392f8aada21b0f7ec2f7a41dc00">error</a> = 0;
        <span class="keywordflow">for</span> (uint8_t i = 1; i &lt; entry-&gt;<a class="code" href="classSimpleNodeEntry.html#ac610faa095266e4117d51855ac19abd2">getDim</a>(); i++) {
            error += pow(coords[i] - entry-&gt;<a class="code" href="classSimpleNodeEntry.html#adbec5d28d5bf0371394e43a323d10f03">getCoords</a>(i), 2);
        }
        error = sqrt(error);

        <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#a0ffa19a84d406ad8de4b86148a5879ad" title="pointer to GlobalStatistics module in this node">globalStatistics</a>
          -&gt;<a class="code" href="classGlobalStatistics.html#a6a697a0b67f344e4bc214159761f943a" title="Add a new value to the cStdDev container specified by the name parameter.">addStdDev</a>(<span class="stringliteral">&quot;NPS: Coordinate difference&quot;</span>, error);

        <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d">neighborCache</a>.clear(); <span class="comment">//TODO</span>
        <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#a13fe4a3a70c426257244008e5e1fd0f9">neighborCacheExpireMap</a>.clear(); <span class="comment">//TODO</span>

        <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;getParentModule()
            -&gt;bubble(<span class="stringliteral">&quot;GNP/NPS coordinates calculated -&gt; JOIN overlay!&quot;</span>);

        <span class="keywordflow">if</span> (<a class="code" href="classNps.html#a2f2d88bdce6b96f3819bb1876dd3d785">coordBasedRouting</a>) {
            <span class="keywordtype">int</span> bitsPerDigit = <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseOverlay.html#afcab85a6c5a4f8aa70a65ecabaa78180">getBitsPerDigit</a>();
            <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#af3992f1fda9ea42dc10bf4739e47700a" title="saves given key to NodeHandle::key">setKey</a>(
                <a class="code" href="classNps.html#a2f2d88bdce6b96f3819bb1876dd3d785">coordBasedRouting</a>-&gt;<a class="code" href="classCoordBasedRouting.html#a9ff382ebaca0bb0ddcdf8ffe72ffb9e3" title="returns a NodeID with given length and prefix according to coords&amp;#39; area.">getNodeId</a>(coords, bitsPerDigit,
                                             <a class="code" href="classOverlayKey.html#af855a4dfc0e5dc0d2afc6b87fa1d7426" title="Returns the length in number of bits.">OverlayKey::getLength</a>()));

            EV &lt;&lt; <span class="stringliteral">&quot;[Nps::coordsReqRpcResponse() @ &quot;</span>
               &lt;&lt; <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>()
               &lt;&lt; <span class="stringliteral">&quot; (&quot;</span> &lt;&lt; <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; <span class="stringliteral">&quot;)]&quot;</span>
               &lt;&lt; <span class="stringliteral">&quot;\n    -&gt; nodeID ( 2): &quot;</span>
               &lt;&lt; <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(2)
               &lt;&lt; <span class="stringliteral">&quot;\n    -&gt; nodeID (16): &quot;</span>
               &lt;&lt; <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>().<a class="code" href="classOverlayKey.html#aabeb4fd284a630a82e982ba34ece4fd9" title="Returns a string representation of this key.">toString</a>(16) &lt;&lt; endl;

            <span class="comment">// returning to BaseOverlay</span>
            <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseOverlay.html#acb8855faa86247ae37ab894891d9f4dd" title="Join the overlay with a given nodeID.">join</a>(<a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a88eb68c06450fd12ea072f471bf1c1b8" title="NodeHandle to this node.">thisNode</a>.<a class="code" href="classNodeHandle.html#aef531103cdf07c8353267f4d30a80112" title="returns key of this NodeHandle">getKey</a>());
        } <span class="keywordflow">else</span> {
            <span class="comment">// returning to BaseOverlay</span>
            <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseOverlay.html#acb8855faa86247ae37ab894891d9f4dd" title="Join the overlay with a given nodeID.">join</a>();
        }
    } <span class="keywordflow">else</span> {
        <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#a057e94a37705dfab0ab1f91417603450">updateNode</a>(srcNode, rtt, <a class="code" href="classNodeHandle.html#a79bf2c5e29c969cbd0b2581cb188d8a6" title="the unspecified NodeHandle">NodeHandle::UNSPECIFIED_NODE</a>,
                                  coordsInfo);
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2096cd53969a1301c89b80690c38b824"></a><!-- doxytag: member="Nps::createNcsInfo" ref="a2096cd53969a1301c89b80690c38b824" args="(const std::vector&lt; double &gt; &amp;coords) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> * Nps::createNcsInfo </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>coords</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classAbstractNcs.html#a5bc9714acefffb7688b5fdeeac67af9a">AbstractNcs</a>.</p>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00633">633</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    assert(coords.size() &gt; 1);
    <a class="code" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>* info = <span class="keyword">new</span> <a class="code" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>();

    uint8_t i;
    <span class="keywordflow">for</span> (i = 0; i &lt; coords.size() - 1; ++i) {
        info-&gt;setCoords(i, coords[i]);
    }
    info-&gt;setLayer(coords[i]);

    <span class="keywordflow">return</span> info;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a907d7e0eb33fdcadd97c141e47dc9bb2"></a><!-- doxytag: member="Nps::deleteNodeMeasurement" ref="a907d7e0eb33fdcadd97c141e47dc9bb2" args="(const TransportAddress &amp;node)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::deleteNodeMeasurement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>node</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00616">616</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, and <a class="el" href="Nps_8cc_source.html#l00106">handleRpcTimeout()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">for</span>(uint i = 0; i &lt; <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>.size(); i++) {
        <span class="keywordflow">if</span> (<a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].measuredNode == node) {
<span class="preprocessor">#ifdef EXTJOIN_DISCOVERY</span>
<span class="preprocessor"></span>            <span class="keyword">delete</span> <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].message;
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>            <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>.erase(<a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>.begin()+i);
            i--;
        }
    }
    <span class="keywordflow">if</span> (<a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>.size() == 0) {
        <span class="comment">//stopNodeMeasurement();</span>
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="af641f9c68efaa852a7afe2389706c305"></a><!-- doxytag: member="Nps::enoughLandmarks" ref="af641f9c68efaa852a7afe2389706c305" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Nps::enoughLandmarks </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00555">555</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00073">handleTimerEvent()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> (<a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a>-&gt;<a class="code" href="classGlobalNodeList.html#ad4be38c469514c678ee0057eeb65ed65">getLandmarkPeerSize</a>() &gt; <a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a>);
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a75d836ef63e2622f55fa5c7524113068"></a><!-- doxytag: member="Nps::getCoordinateBasedProx" ref="a75d836ef63e2622f55fa5c7524113068" args="(const AbstractNcsNodeInfo &amp;info) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structProx.html">Prox</a> Nps::getCoordinateBasedProx </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>info</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classAbstractNcs.html#a448ab29cb9bd376b3181f1e5f282a98c">AbstractNcs</a>.</p>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00561">561</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordflow">return</span> <a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a>-&gt;<a class="code" href="classEuclideanNcsNodeInfo.html#a55da7d34e6813fe743e657f5ce847e00">getDistance</a>(abstractInfo);

    <span class="comment">/*</span>
<span class="comment">    if (!dynamic_cast&lt;const GnpNpsCoordsInfo*&gt;(&amp;abstractInfo)) {</span>
<span class="comment">            throw cRuntimeError(&quot;GNP/NPS coords needed!&quot;);</span>
<span class="comment">    }</span>
<span class="comment"></span>
<span class="comment">    const GnpNpsCoordsInfo&amp; info =</span>
<span class="comment">        *(static_cast&lt;const GnpNpsCoordsInfo*&gt;(&amp;abstractInfo));</span>
<span class="comment"></span>
<span class="comment">    double dist = 0.0;</span>
<span class="comment">    uint32_t size = info.getDimension();</span>
<span class="comment"></span>
<span class="comment">    for (uint32_t i = 0; i &lt; size; i++) {</span>
<span class="comment">        dist += pow(ownCoords-&gt;getCoords(i) - info.getCoords(i), 2);</span>
<span class="comment">    }</span>
<span class="comment">    dist = sqrt(dist);</span>
<span class="comment"></span>
<span class="comment">    return Prox(dist, 0.0); //TODO accuracy</span>
<span class="comment">    */</span>
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="af27e095e68e6267c245bf308390e2bda"></a><!-- doxytag: member="Nps::getLandmarkData" ref="af27e095e68e6267c245bf308390e2bda" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structLandmarkDataEntry.html">LandmarkDataEntry</a>&gt; Nps::getLandmarkData </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="a196455a5bbd7d13e32046d49491a4a1b"></a><!-- doxytag: member="Nps::getLandmarks" ref="a196455a5bbd7d13e32046d49491a4a1b" args="(uint8_t howmany)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; Nps::getLandmarks </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>howmany</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Askes <a class="el" href="classGlobalNodeList.html" title="Global module (formerly known as GlobalNodeList) that supports the node bootstrap process and contain...">GlobalNodeList</a> for appropriate landmark nodes. </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>howmany</em>&nbsp;</td><td>number of needed landmark nodes </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>vector of landmark addresses </dd></dl>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00528">528</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00422">sendCoordRequests()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    std::vector&lt;TransportAddress&gt; returnPool;

    <span class="keywordflow">if</span> (howmany &gt; <a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a>-&gt;<a class="code" href="classGlobalNodeList.html#ad4be38c469514c678ee0057eeb65ed65">getLandmarkPeerSize</a>()) {
        <span class="keywordflow">throw</span> cRuntimeError(<span class="stringliteral">&quot;Not enough landmarks available in network!&quot;</span>);
    }

    <span class="keywordflow">while</span> (returnPool.size() &lt; howmany) {
        <a class="code" href="classTransportAddress.html" title="This class implements a common transport address.">TransportAddress</a>* lm = <a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a>-&gt;<a class="code" href="classGlobalNodeList.html#ae1844000ce593cb00831e55e9124ac53" title="Selects a random node from the peerSet, which is not already marked for deletion.">getRandomAliveNode</a>();
        <a class="code" href="classPeerInfo.html" title="Base class for providing additional underlay specific information associated with a certain transport...">PeerInfo</a>* lmInfo = <a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a>-&gt;<a class="code" href="classGlobalNodeList.html#a985bf687f11d68d4a6699e7fa2367e9a" title="Searches the peerSet for the specified node.">getPeerInfo</a>(lm-&gt;<a class="code" href="classTransportAddress.html#a00e613d98d3412e2b92897c25aa0eb4c" title="returns ip address">getIp</a>());
        <span class="keywordflow">if</span> (lmInfo-&gt;<a class="code" href="classPeerInfo.html#a5081c729d9f242ad2c0e8fba6f74b809" title="returns the NPS layer of the peer">getNpsLayer</a>() &gt;= 0 &amp;&amp;
            lmInfo-&gt;<a class="code" href="classPeerInfo.html#a5081c729d9f242ad2c0e8fba6f74b809" title="returns the NPS layer of the peer">getNpsLayer</a>() &lt; <a class="code" href="classNps.html#ae3c83ca224d7cf2ab4e71cafacecfa07">maxLayer</a>) {
            <span class="comment">// already in returnPool?</span>
            <span class="keywordtype">bool</span> alreadyin = <span class="keyword">false</span>;
            <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; returnPool.size(); i++) {
                <span class="keywordflow">if</span> (returnPool[i] == *lm)
                    alreadyin = <span class="keyword">true</span>;
            }
            <span class="keywordflow">if</span> (alreadyin == <span class="keyword">false</span>) {
                returnPool.push_back(*lm);
            }
        }
    }
    <span class="keywordflow">return</span> returnPool;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a844b41690ecd7c494b3f21f7e59c6edb"></a><!-- doxytag: member="Nps::getLandmarkSet" ref="a844b41690ecd7c494b3f21f7e59c6edb" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="classTransportAddress.html">TransportAddress</a>&gt;&amp; Nps::getLandmarkSet </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00171">171</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>; };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3f9826cfa483983300c7de618b9f98a6"></a><!-- doxytag: member="Nps::getLandmarkSetSize" ref="a3f9826cfa483983300c7de618b9f98a6" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Nps::getLandmarkSetSize </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00172">172</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>.size(); };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a537a106ab588ceeb1188e8e467df9e25"></a><!-- doxytag: member="Nps::getOwnCoordinates" ref="a537a106ab588ceeb1188e8e467df9e25" args="(uint8_t i) const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Nps::getOwnCoordinates </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>i</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00114">114</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a>-&gt;<a class="code" href="classEuclideanNcsNodeInfo.html#a43b66b96092e688a0e775b7c795f96c5">getCoords</a>(i); };
</pre></div></p>

</div>
</div>
<a class="anchor" id="aea00852807177b7877c0850960e0bd14"></a><!-- doxytag: member="Nps::getOwnCoordinates" ref="aea00852807177b7877c0850960e0bd14" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;double&gt;&amp; Nps::getOwnCoordinates </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00113">113</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00160">coordsReqRpc()</a>, <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, and <a class="el" href="Nps_8cc_source.html#l00106">handleRpcTimeout()</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a>-&gt;<a class="code" href="classEuclideanNcsNodeInfo.html#a43b66b96092e688a0e775b7c795f96c5">getCoords</a>(); };
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2adba20baee99d4a34eaae6231e2a9c3"></a><!-- doxytag: member="Nps::getOwnLayer" ref="a2adba20baee99d4a34eaae6231e2a9c3" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t Nps::getOwnLayer </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00115">115</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00449">computeOwnLayer()</a>, and <a class="el" href="Nps_8cc_source.html#l00160">coordsReqRpc()</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a>-&gt;<a class="code" href="classGnpNpsCoordsInfo.html#aa79b0f19b890c91eb64d802b5bb23f0f">getLayer</a>(); };
</pre></div></p>

</div>
</div>
<a class="anchor" id="acf6a58594d71c593f29f2b937d0340ae"></a><!-- doxytag: member="Nps::getOwnNcsInfo" ref="acf6a58594d71c593f29f2b937d0340ae" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">virtual const <a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a>&amp; Nps::getOwnNcsInfo </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classAbstractNcs.html#afb2c12a5b86a18f15f7a47a95d8bfc4e">AbstractNcs</a>.</p>

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00111">111</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> *<a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a>; };
</pre></div></p>

</div>
</div>
<a class="anchor" id="abfc6be18674ec13546a90a587264f315"></a><!-- doxytag: member="Nps::getReceivedCalls" ref="abfc6be18674ec13546a90a587264f315" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t Nps::getReceivedCalls </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00187">187</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p><div class="fragment"><pre class="fragment">{ <span class="keywordflow">return</span> <a class="code" href="classNps.html#a2ac887be6d5f1333cefc902be95ddfa7">receivedCalls</a>; };
</pre></div></p>

</div>
</div>
<a class="anchor" id="aaeec7877761f56e11a0523e8823c09b7"></a><!-- doxytag: member="Nps::getUnvalidNcsInfo" ref="aaeec7877761f56e11a0523e8823c09b7" args="() const " -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classAbstractNcsNodeInfo.html">AbstractNcsNodeInfo</a>* Nps::getUnvalidNcsInfo </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td> const<code> [inline, virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classAbstractNcs.html#a2fa10cf709bc05c46a87fccb1a5a7020">AbstractNcs</a>.</p>

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00109">109</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p><div class="fragment"><pre class="fragment">{<span class="keywordflow">return</span> <span class="keyword">new</span> <a class="code" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>; };
</pre></div></p>

</div>
</div>
<a class="anchor" id="af65b7ba515df95cfb26de4ab7bdaf07f"></a><!-- doxytag: member="Nps::handleRpcCall" ref="af65b7ba515df95cfb26de4ab7bdaf07f" args="(BaseCallMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Nps::handleRpcCall </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classAbstractNcs.html#ad4866b8d1f605a32ec74e27eef5bfcd4">AbstractNcs</a>.</p>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00150">150</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="RpcMacros_8h.html#aa75b135e279b574267e1a7dc4ab79da4" title="Marks the beginning of a Remote-Procedure-Call Switch block.">RPC_SWITCH_START</a>( msg );
        <a class="code" href="RpcMacros_8h.html#ad81d44e9bc59d2fb2cfcacc4d5ecda35" title="Declares a RPC method delegation.">RPC_DELEGATE</a>( CoordsReq, <a class="code" href="classNps.html#ae2354ae4c693d9d4dc6e57de89c44790">coordsReqRpc</a> );
        <span class="comment">//if (discovery)</span>
    <a class="code" href="RpcMacros_8h.html#a29a8a3f21e67ecb25f58608a54df5191" title="Marks the end of a Remote-Procedure-Call Switch block.">RPC_SWITCH_END</a>( );

    <span class="keywordflow">return</span> RPC_HANDLED;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="aa1dd1d909f093a487b2a6b67fe37ca28"></a><!-- doxytag: member="Nps::handleRpcResponse" ref="aa1dd1d909f093a487b2a6b67fe37ca28" args="(BaseResponseMessage *msg, cPolymorphic *context, int rpcId, simtime_t rtt)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::handleRpcResponse </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseResponseMessage.html">BaseResponseMessage</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&nbsp;</td>
          <td class="paramname"> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rpcId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&nbsp;</td>
          <td class="paramname"> <em>rtt</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00087">87</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="comment">// call rpc stubs</span>
    <a class="code" href="RpcMacros_8h.html#aa75b135e279b574267e1a7dc4ab79da4" title="Marks the beginning of a Remote-Procedure-Call Switch block.">RPC_SWITCH_START</a>( msg );
        <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( CoordsReq ) {
            <a class="code" href="classNps.html#a27eb36ff406f9fe0d2fdb5f41a479ab5">coordsReqRpcResponse</a>(_CoordsReqResponse, context, rpcId, rtt);
        }
<span class="preprocessor">#ifdef EXTJOIN_DISCOVERY</span>
<span class="preprocessor"></span>        <a class="code" href="RpcMacros_8h.html#a0394d2dc4f9f1e15d7e99c9f43da10c7">RPC_ON_RESPONSE</a>( RttToNode ) {
            rttToNodeRpcResponse(_RttToNodeResponse, context, rpcId, rtt);
        }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    <a class="code" href="RpcMacros_8h.html#a29a8a3f21e67ecb25f58608a54df5191" title="Marks the end of a Remote-Procedure-Call Switch block.">RPC_SWITCH_END</a>( );

    <span class="keywordflow">return</span>;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2b19076c7801b2ca41b6b1e400571f9c"></a><!-- doxytag: member="Nps::handleRpcTimeout" ref="a2b19076c7801b2ca41b6b1e400571f9c" args="(BaseCallMessage *msg, const TransportAddress &amp;dest, cPolymorphic *context, int rpcId, const OverlayKey &amp;destKey)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::handleRpcTimeout </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classBaseCallMessage.html">BaseCallMessage</a> *&nbsp;</td>
          <td class="paramname"> <em>msg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">cPolymorphic *&nbsp;</td>
          <td class="paramname"> <em>context</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>rpcId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classOverlayKey.html">OverlayKey</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>destKey</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00106">106</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="RpcMacros_8h.html#aa75b135e279b574267e1a7dc4ab79da4" title="Marks the beginning of a Remote-Procedure-Call Switch block.">RPC_SWITCH_START</a>( msg ) {

        <a class="code" href="RpcMacros_8h.html#ae07fad586ce7b9e82ad12848767a32e5">RPC_ON_CALL</a>( CoordsReq ) {
            <span class="keywordflow">if</span> (<span class="keyword">true</span><span class="comment">/*doingNodeMeasurement()*/</span>) {<span class="comment">//TODO</span>
<span class="preprocessor">#ifdef EXTJOIN_DISCOVERY</span>
<span class="preprocessor"></span>                <span class="keywordflow">if</span> (getPendingRttsReq(dest) == -1) {
                    <a class="code" href="classRttToNodeCall.html" title="Class generated from common/cbr/CoordMessages.msg by opp_msgc.">RttToNodeCall</a>* call = getNodeMessage(dest);

                    <a class="code" href="classRttToNodeResponse.html" title="Class generated from common/cbr/CoordMessages.msg by opp_msgc.">RttToNodeResponse</a>* rttRes = <span class="keyword">new</span> <a class="code" href="classRttToNodeResponse.html" title="Class generated from common/cbr/CoordMessages.msg by opp_msgc.">RttToNodeResponse</a>(<span class="stringliteral">&quot;RttToNodeXRes&quot;</span>);
                    rttRes-&gt;<a class="code" href="classRttToNodeResponse.html#a3a54f20e65e557a9920de288a54bd4fa">setPingedNode</a>(dest);
                    rttRes-&gt;<a class="code" href="classRttToNodeResponse.html#a83c2cb099597a80946be3ea5fb93c4d3">setRttToNode</a>(0);
                    std::vector&lt;double&gt; tempOwnCoords;
                    tempOwnCoords = <a class="code" href="classNps.html#aea00852807177b7877c0850960e0bd14">getOwnCoordinates</a>();
                    rttRes-&gt;<a class="code" href="classRttToNodeResponse.html#a68c6f1ede76e28ed787224b0aaf885a7">setOwnCoordinatesArraySize</a>(tempOwnCoords.size());
                    <span class="keywordflow">for</span> (uint i = 0; i &lt; tempOwnCoords.size(); i++) {
                        rttRes-&gt;<a class="code" href="classRttToNodeResponse.html#acc575232367863a997435728427b58e3">setOwnCoordinates</a>(i, tempOwnCoords[i]);
                    }
                    sendRpcResponse(call, rttRes);
                    <a class="code" href="classNps.html#a907d7e0eb33fdcadd97c141e47dc9bb2">deleteNodeMeasurement</a>(dest);
                } <span class="keywordflow">else</span> {
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>                    <a class="code" href="classNps.html#a3714d1d15661715ae6d7b75e74d0968e">updateNodeMeasurement</a>(dest, -1);
<span class="preprocessor">#ifdef EXTJOIN_DISCOVERY</span>
<span class="preprocessor"></span>                }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>
            } <span class="keywordflow">else</span> {
                <a class="code" href="classNps.html#ac09a03018ddd419b62867c516974090a">pendingRequests</a>--;
            }
        }
<span class="preprocessor">#ifdef EXTJOIN_DISCOVERY</span>
<span class="preprocessor"></span>        <a class="code" href="RpcMacros_8h.html#ae07fad586ce7b9e82ad12848767a32e5">RPC_ON_CALL</a>( RttToNode ) {
            <a class="code" href="classNps.html#a3714d1d15661715ae6d7b75e74d0968e">updateNodeMeasurement</a>(dest, -1);
        }
<span class="preprocessor">#endif</span>
<span class="preprocessor"></span>    }
    <a class="code" href="RpcMacros_8h.html#a29a8a3f21e67ecb25f58608a54df5191" title="Marks the end of a Remote-Procedure-Call Switch block.">RPC_SWITCH_END</a>( )
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a2291e96c9b071a2110bcd2a36dec631e"></a><!-- doxytag: member="Nps::handleTimerEvent" ref="a2291e96c9b071a2110bcd2a36dec631e" args="(cMessage *msg)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::handleTimerEvent </td>
          <td>(</td>
          <td class="paramtype">cMessage *&nbsp;</td>
          <td class="paramname"> <em>msg</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Reimplemented from <a class="el" href="classAbstractNcs.html#a162e9b1dc50c85190c0da04b58fc0053">AbstractNcs</a>.</p>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00073">73</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="comment">// process landmark timer message</span>
    <span class="keywordflow">if</span> (msg == <a class="code" href="classNps.html#a69f19f64cd77c044e0f7b601d6ad6664">landmarkTimer</a>) {
        <span class="keywordflow">if</span> (<a class="code" href="classNps.html#af641f9c68efaa852a7afe2389706c305">enoughLandmarks</a>()) {
            <span class="keyword">delete</span> msg;
            <span class="comment">//std::cout &lt;&lt; &quot;[&quot; &lt;&lt; getThisNode().getIp() &lt;&lt; &quot;] (Re-)Trying to contact landmarks&quot; &lt;&lt; std::endl;</span>
            <a class="code" href="classNps.html#a83407d363a852ab9dfc70f2aa10e058d" title="Get a random set of landmarks / NPS reference node and send coordinate requests to them...">sendCoordRequests</a>();
        } <span class="keywordflow">else</span> {
            <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;scheduleAt(simTime() + <a class="code" href="classNps.html#a60317df69b6b5dc8d8095bae37891686">landmarkTimeout</a>, msg);
        }
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3e6d73fa177dc950505a934a4e0c92c6"></a><!-- doxytag: member="Nps::init" ref="a3e6d73fa177dc950505a934a4e0c92c6" args="(NeighborCache *neighborCache)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classNeighborCache.html">NeighborCache</a> *&nbsp;</td>
          <td class="paramname"> <em>neighborCache</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [virtual]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Implements <a class="el" href="classAbstractNcs.html#ab7fa98f9830542958ad75f715abf2b61">AbstractNcs</a>.</p>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00041">41</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    this-&gt;neighborCache = neighborCache;
    <a class="code" href="classNps.html#a2fa1935935077a421a76979a613e4517">overlay</a> = neighborCache-&gt;<a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>;

    <a class="code" href="classNps.html#ae3c83ca224d7cf2ab4e71cafacecfa07">maxLayer</a> = neighborCache-&gt;par(<span class="stringliteral">&quot;npsMaxLayer&quot;</span>);
    <a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a> = neighborCache-&gt;par(<span class="stringliteral">&quot;gnpDimensions&quot;</span>);
    <a class="code" href="classNps.html#a60317df69b6b5dc8d8095bae37891686">landmarkTimeout</a> = neighborCache-&gt;par(<span class="stringliteral">&quot;gnpLandmarkTimeout&quot;</span>);

    <a class="code" href="classEuclideanNcsNodeInfo.html#a006113915f1e9cf7f802ec400c1dc264">GnpNpsCoordsInfo::setDimension</a>(<a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a>);
    <a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a> = <span class="keyword">new</span> <a class="code" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>();

    <a class="code" href="classNps.html#a2ac887be6d5f1333cefc902be95ddfa7">receivedCalls</a> = 0;
    <a class="code" href="classNps.html#ac09a03018ddd419b62867c516974090a">pendingRequests</a> = 0;
    <a class="code" href="classNps.html#a42ccd3f2efe12d99bdf6a1cae8771f38">coordCalcRuns</a> = neighborCache-&gt;par(<span class="stringliteral">&quot;npsCoordCalcRuns&quot;</span>);

    WATCH(*<a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a>);
    WATCH_VECTOR(<a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>);

    <a class="code" href="classNps.html#a2f2d88bdce6b96f3819bb1876dd3d785">coordBasedRouting</a> = <a class="code" href="classCoordBasedRoutingAccess.html" title="Gives access to the CoordBasedRouting.">CoordBasedRoutingAccess</a>().get();
    <a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a> = <a class="code" href="classGlobalNodeListAccess.html" title="Gives access to the GlobalNodeList.">GlobalNodeListAccess</a>().get();

    <span class="keywordflow">if</span> (neighborCache-&gt;getParentModule()-&gt;getModuleByRelativePath(<span class="stringliteral">&quot;tier1&quot;</span>)
        -&gt;getModuleByRelativePath(<span class="stringliteral">&quot;landmark&quot;</span>) == NULL) {
        <a class="code" href="classNps.html#a69f19f64cd77c044e0f7b601d6ad6664">landmarkTimer</a> = <span class="keyword">new</span> cMessage(<span class="stringliteral">&quot;landmarkTimer&quot;</span>);
        neighborCache-&gt;scheduleAt(simTime() + <a class="code" href="classNps.html#a60317df69b6b5dc8d8095bae37891686">landmarkTimeout</a>, <a class="code" href="classNps.html#a69f19f64cd77c044e0f7b601d6ad6664">landmarkTimer</a>);
    } <span class="keywordflow">else</span> {
        <span class="comment">// GNP-landmark or NPS-Layer-0-landmark</span>
        <a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a>-&gt;<a class="code" href="classGnpNpsCoordsInfo.html#aeb654b36205235ddaeef5b93c8ae4da7">setLayer</a>(0); <span class="comment">//TODO double, see Landmark.cc</span>
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a83407d363a852ab9dfc70f2aa10e058d"></a><!-- doxytag: member="Nps::sendCoordRequests" ref="a83407d363a852ab9dfc70f2aa10e058d" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::sendCoordRequests </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><a class="el" href="classGet.html">Get</a> a random set of landmarks / NPS reference node and send coordinate requests to them. </p>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00422">422</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00073">handleTimerEvent()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    std::vector &lt;TransportAddress&gt; landmarks;
    landmarks = <a class="code" href="classNps.html#a196455a5bbd7d13e32046d49491a4a1b" title="Askes GlobalNodeList for appropriate landmark nodes.">getLandmarks</a>(<a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a> + 1);

    simtime_t timeout = -1;

    <span class="keywordflow">if</span> (landmarks.size() &gt; 0) {
        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> i = 0; i &lt; landmarks.size(); i++) {
            <span class="keyword">const</span> <a class="code" href="classTransportAddress.html" title="This class implements a common transport address.">TransportAddress</a>&amp; tolm = landmarks[i];
            <a class="code" href="classNps.html#ac3d69d35fad31b52f5fc039dcff01d6d">sendCoordsReqCall</a>(tolm, timeout);
        }
        <a class="code" href="classNps.html#a9a402f06e7948d4c86dec35c529a08bc">setLandmarkSet</a>(<a class="code" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">dimensions</a> + 1, <a class="code" href="classNps.html#ae3c83ca224d7cf2ab4e71cafacecfa07">maxLayer</a>, &amp;<a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>);
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="ad62b1be7467dc7f6bf31dcbe021ebc1c"></a><!-- doxytag: member="Nps::sendCoordRequests" ref="ad62b1be7467dc7f6bf31dcbe021ebc1c" args="(const std::vector&lt; TransportAddress &gt; &amp;landmarks)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::sendCoordRequests </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>landmarks</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

</div>
</div>
<a class="anchor" id="ac3d69d35fad31b52f5fc039dcff01d6d"></a><!-- doxytag: member="Nps::sendCoordsReqCall" ref="ac3d69d35fad31b52f5fc039dcff01d6d" args="(const TransportAddress &amp;dest, simtime_t timeout)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::sendCoordsReqCall </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>dest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">simtime_t&nbsp;</td>
          <td class="paramname"> <em>timeout</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00438">438</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00422">sendCoordRequests()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classCoordsReqCall.html" title="Class generated from common/Nps.msg by opp_msgc.">CoordsReqCall</a>* coordReq = <span class="keyword">new</span> <a class="code" href="classCoordsReqCall.html" title="Class generated from common/Nps.msg by opp_msgc.">CoordsReqCall</a>(<span class="stringliteral">&quot;CoordsReq&quot;</span>);
    coordReq-&gt;setBitLength(<a class="code" href="Nps__m_8h.html#afac75b55e04e5fb85f432a2cde6dd01a">COORDSREQCALL_L</a>(coordReq));
    <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a816918e82652f724c291923e018eabe2" title="Routes a Remote-Procedure-Call message to an OverlayKey.">sendRouteRpcCall</a>(<a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#aa6aafdbff910a02b3dc631a57f2b3ac4">getThisCompType</a>(), dest,
                                    coordReq, NULL, NO_OVERLAY_ROUTING,
                                    timeout, 0, -1, <span class="keyword">this</span>);
    <a class="code" href="classNps.html#ac09a03018ddd419b62867c516974090a">pendingRequests</a>++;
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a9a402f06e7948d4c86dec35c529a08bc"></a><!-- doxytag: member="Nps::setLandmarkSet" ref="a9a402f06e7948d4c86dec35c529a08bc" args="(uint8_t howManyLM, uint8_t maxLayer, std::vector&lt; TransportAddress &gt; *landmarkSet)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Nps::setLandmarkSet </td>
          <td>(</td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>howManyLM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>maxLayer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="classTransportAddress.html">TransportAddress</a> &gt; *&nbsp;</td>
          <td class="paramname"> <em>landmarkSet</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00392">392</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, and <a class="el" href="Nps_8cc_source.html#l00422">sendCoordRequests()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>-&gt;clear();
    <a class="code" href="classNeighborCache.html#aed1572b2a597a0654f4d355760aa5942">NeighborCache::NeighborCacheIterator</a> it;
    uint availableLM = 0;
    <a class="code" href="classTransportAddress.html" title="This class implements a common transport address.">TransportAddress</a> landmark;
    <span class="keywordflow">for</span>(it = <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d">neighborCache</a>.begin(); it != <a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classNeighborCache.html#a6f9e10ff6b8ac2ecb0f8126f77a8ad4d">neighborCache</a>.end(); it++ ) {
        <span class="keywordflow">if</span> (dynamic_cast&lt;GnpNpsCoordsInfo*&gt;(it-&gt;second.coordsInfo) &amp;&amp;
            <span class="keyword">static_cast&lt;</span><a class="code" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>*<span class="keyword">&gt;</span>(it-&gt;second.coordsInfo)-&gt;getLayer()
                &lt; <a class="code" href="classNps.html#ae3c83ca224d7cf2ab4e71cafacecfa07">maxLayer</a>) {
            landmark.<a class="code" href="classTransportAddress.html#a1c7b834dc2e6e738f1f4db8711a12814" title="Sets the ip address, port and NAT type.">setIp</a>(it-&gt;first.getIp());
            landmark.<a class="code" href="classTransportAddress.html#a46a1b53760e5f2d3f8af8c9591160a48" title="sets this-&amp;gt;port to the given port">setPort</a>(it-&gt;second.nodeRef.getPort());
            <a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>-&gt;push_back(landmark);
            availableLM++;
        }
    }
    <span class="keywordflow">if</span> (availableLM &lt; howManyLM) {
        <span class="keywordflow">return</span> <span class="keyword">false</span>;
    } <span class="keywordflow">else</span> {
        uint i = availableLM;
        <span class="keywordflow">while</span> (i &gt; howManyLM) {
            uint randomNumber = (intuniform(0, <a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>-&gt;size()));
            <a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>-&gt;erase(<a class="code" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">landmarkSet</a>-&gt;begin() + randomNumber);
            i--;
        }
        <span class="keywordflow">return</span> <span class="keyword">true</span>;
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a09bd43b58b11f180242a6c2feac49261"></a><!-- doxytag: member="Nps::setOwnCoordinates" ref="a09bd43b58b11f180242a6c2feac49261" args="(const std::vector&lt; double &gt; &amp;coords)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::setOwnCoordinates </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&nbsp;</td>
          <td class="paramname"> <em>coords</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [inline, protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00132">132</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00495">computeOwnCoordinates()</a>, and <a class="el" href="Landmark_8cc_source.html#l00039">Landmark::initializeApp()</a>.</p>

<p><div class="fragment"><pre class="fragment">                                                            {
        <span class="keywordflow">for</span> (uint8_t i = 0; i &lt; coords.size(); ++i) {
            <a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a>-&gt;<a class="code" href="classEuclideanNcsNodeInfo.html#aff86e96ad92b1cca727a2a3d44acfe68">setCoords</a>(i, coords[i]);
        }
    };
</pre></div></p>

</div>
</div>
<a class="anchor" id="af18fa643b698f2fabe02d7c0be7ecf4b"></a><!-- doxytag: member="Nps::setOwnLayer" ref="af18fa643b698f2fabe02d7c0be7ecf4b" args="(int8_t layer)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::setOwnLayer </td>
          <td>(</td>
          <td class="paramtype">int8_t&nbsp;</td>
          <td class="paramname"> <em>layer</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>announces node's NPS layer to Bootstrap Oracle and Neighbor Cache </p>

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00460">460</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00449">computeOwnLayer()</a>, and <a class="el" href="Landmark_8cc_source.html#l00039">Landmark::initializeApp()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <a class="code" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">ownCoords</a>-&gt;<a class="code" href="classGnpNpsCoordsInfo.html#aeb654b36205235ddaeef5b93c8ae4da7">setLayer</a>(layer);

    <span class="comment">// Update in BootstrapOracle</span>
    <a class="code" href="classPeerInfo.html" title="Base class for providing additional underlay specific information associated with a certain transport...">PeerInfo</a>* thisInfo = <a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a>-&gt;<a class="code" href="classGlobalNodeList.html#a985bf687f11d68d4a6699e7fa2367e9a" title="Searches the peerSet for the specified node.">getPeerInfo</a>(<a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#ac3f420630d5618e81709c078b06fd9da" title="Returns the NodeHandle of this node.">getThisNode</a>());
    thisInfo-&gt;<a class="code" href="classPeerInfo.html#a9ddada01c7e69d45a14337aaf3c64692" title="set the NPS layer of the peer">setNpsLayer</a>(layer);

    <span class="comment">// Workaround against -1 ports in BS oracle</span>
    <span class="keywordflow">if</span> (layer &gt; 0) <a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a>-&gt;<a class="code" href="classGlobalNodeList.html#a899ad6c05afd68010414ea519540f7c6" title="Update entry to real port without having bootstrapped.">refreshEntry</a>(<a class="code" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">neighborCache</a>-&gt;<a class="code" href="classBaseRpc.html#a9a633ad17071241f981fb76a9678337a">overlay</a>-&gt;<a class="code" href="classBaseRpc.html#ac3f420630d5618e81709c078b06fd9da" title="Returns the NodeHandle of this node.">getThisNode</a>());
    <span class="keywordflow">if</span> (layer &lt; <a class="code" href="classNps.html#ae3c83ca224d7cf2ab4e71cafacecfa07">maxLayer</a>) {
        <a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a>-&gt;<a class="code" href="classGlobalNodeList.html#a645a57272e9ca434469af5e4156be8d3">incLandmarkPeerSize</a>();
        <a class="code" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">globalNodeList</a>-&gt;<a class="code" href="classGlobalNodeList.html#a77494a9be212c2c424047806b559f086">incLandmarkPeerSizePerType</a>(thisInfo-&gt;<a class="code" href="classPeerInfo.html#a7b01dcdd9a7828c03feef39d5135ab1d" title="returns the type of the node">getTypeID</a>());
    }
}
</pre></div></p>

</div>
</div>
<a class="anchor" id="a3714d1d15661715ae6d7b75e74d0968e"></a><!-- doxytag: member="Nps::updateNodeMeasurement" ref="a3714d1d15661715ae6d7b75e74d0968e" args="(const TransportAddress &amp;node, uint8_t pending=0, uint8_t sent=0, uint8_t passed=0)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void Nps::updateNodeMeasurement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classTransportAddress.html">TransportAddress</a> &amp;&nbsp;</td>
          <td class="paramname"> <em>node</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>pending</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>sent</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&nbsp;</td>
          <td class="paramname"> <em>passed</em> = <code>0</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8cc_source.html#l00585">585</a> of file <a class="el" href="Nps_8cc_source.html">Nps.cc</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, and <a class="el" href="Nps_8cc_source.html#l00106">handleRpcTimeout()</a>.</p>

<p><div class="fragment"><pre class="fragment">{
    <span class="keywordtype">bool</span> alreadySet = <span class="keyword">false</span>;
    <span class="keywordflow">for</span>(uint i = 0; i &lt; <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>.size(); i++) {
        <span class="keywordflow">if</span> (<a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].measuredNode == node &amp;&amp; sent == 0) {
            <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].rttsPending += pending;
            <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].rttsSent += sent;
            <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].coordsPassed += passed;
            alreadySet = <span class="keyword">true</span>;
            i = <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>.size();
        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].measuredNode == node) {
            <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].rttsPending = pending;
            <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].rttsSent = sent;
            <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>[i].coordsPassed = passed;
            alreadySet = <span class="keyword">true</span>;
            i = <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>.size();
        }
    }
    <span class="keywordflow">if</span> (!alreadySet) {
        <a class="code" href="structRttMeasurement.html">RttMeasurement</a> newNode;
        newNode.<a class="code" href="structRttMeasurement.html#ab77a844579fe6552a042ba0212662dd3">measuredNode</a> = node;
        newNode.<a class="code" href="structRttMeasurement.html#a26687a4282200a75a980744b596eb602">rttsPending</a> = pending;
        newNode.<a class="code" href="structRttMeasurement.html#a070438c178348a071cfc5bbcf910b25e">rttsSent</a> = sent;
        newNode.<a class="code" href="structRttMeasurement.html#a93b4efebbd261138c188e31902461f73">coordsPassed</a> = passed;
        <a class="code" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">nodeMeasurements</a>.push_back(newNode);
    }
}
</pre></div></p>

</div>
</div>
<hr/><h2>Friends And Related Function Documentation</h2>
<a class="anchor" id="a4aa06e10717f2124a0b37ccc3f4dc573"></a><!-- doxytag: member="Nps::Landmark" ref="a4aa06e10717f2124a0b37ccc3f4dc573" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">friend class <a class="el" href="classLandmark.html">Landmark</a><code> [friend]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00078">78</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

</div>
</div>
<hr/><h2>Member Data Documentation</h2>
<a class="anchor" id="a2f2d88bdce6b96f3819bb1876dd3d785"></a><!-- doxytag: member="Nps::coordBasedRouting" ref="a2f2d88bdce6b96f3819bb1876dd3d785" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classCoordBasedRouting.html">CoordBasedRouting</a>* <a class="el" href="classNps.html#a2f2d88bdce6b96f3819bb1876dd3d785">Nps::coordBasedRouting</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00084">84</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, and <a class="el" href="Nps_8cc_source.html#l00041">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a42ccd3f2efe12d99bdf6a1cae8771f38"></a><!-- doxytag: member="Nps::coordCalcRuns" ref="a42ccd3f2efe12d99bdf6a1cae8771f38" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="classNps.html#a42ccd3f2efe12d99bdf6a1cae8771f38">Nps::coordCalcRuns</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00093">93</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00495">computeOwnCoordinates()</a>, and <a class="el" href="Nps_8cc_source.html#l00041">init()</a>.</p>

</div>
</div>
<a class="anchor" id="ac4591caf72dd5aab3376131a9b341459"></a><!-- doxytag: member="Nps::dimensions" ref="ac4591caf72dd5aab3376131a9b341459" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="classNps.html#ac4591caf72dd5aab3376131a9b341459">Nps::dimensions</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00087">87</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00495">computeOwnCoordinates()</a>, <a class="el" href="Nps_8cc_source.html#l00160">coordsReqRpc()</a>, <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, <a class="el" href="Nps_8cc_source.html#l00555">enoughLandmarks()</a>, <a class="el" href="Nps_8cc_source.html#l00041">init()</a>, and <a class="el" href="Nps_8cc_source.html#l00422">sendCoordRequests()</a>.</p>

</div>
</div>
<a class="anchor" id="ae7e18bfcae858bf1ac4808bbdffe8a78"></a><!-- doxytag: member="Nps::globalNodeList" ref="ae7e18bfcae858bf1ac4808bbdffe8a78" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGlobalNodeList.html">GlobalNodeList</a>* <a class="el" href="classNps.html#ae7e18bfcae858bf1ac4808bbdffe8a78">Nps::globalNodeList</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00083">83</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, <a class="el" href="Nps_8cc_source.html#l00555">enoughLandmarks()</a>, <a class="el" href="Nps_8cc_source.html#l00528">getLandmarks()</a>, <a class="el" href="Nps_8cc_source.html#l00041">init()</a>, and <a class="el" href="Nps_8cc_source.html#l00460">setOwnLayer()</a>.</p>

</div>
</div>
<a class="anchor" id="ac6f516e155f3fb4bed2ae7652100633a"></a><!-- doxytag: member="Nps::landmarkSet" ref="ac6f516e155f3fb4bed2ae7652100633a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classTransportAddress.html">TransportAddress</a>&gt; <a class="el" href="classNps.html#ac6f516e155f3fb4bed2ae7652100633a">Nps::landmarkSet</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00095">95</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, <a class="el" href="Nps_8h_source.html#l00171">getLandmarkSet()</a>, <a class="el" href="Nps_8h_source.html#l00172">getLandmarkSetSize()</a>, <a class="el" href="Nps_8cc_source.html#l00041">init()</a>, and <a class="el" href="Nps_8cc_source.html#l00422">sendCoordRequests()</a>.</p>

</div>
</div>
<a class="anchor" id="a60317df69b6b5dc8d8095bae37891686"></a><!-- doxytag: member="Nps::landmarkTimeout" ref="a60317df69b6b5dc8d8095bae37891686" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">simtime_t <a class="el" href="classNps.html#a60317df69b6b5dc8d8095bae37891686">Nps::landmarkTimeout</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00088">88</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00073">handleTimerEvent()</a>, and <a class="el" href="Nps_8cc_source.html#l00041">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a69f19f64cd77c044e0f7b601d6ad6664"></a><!-- doxytag: member="Nps::landmarkTimer" ref="a69f19f64cd77c044e0f7b601d6ad6664" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">cMessage* <a class="el" href="classNps.html#a69f19f64cd77c044e0f7b601d6ad6664">Nps::landmarkTimer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00099">99</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00073">handleTimerEvent()</a>, and <a class="el" href="Nps_8cc_source.html#l00041">init()</a>.</p>

</div>
</div>
<a class="anchor" id="ae3c83ca224d7cf2ab4e71cafacecfa07"></a><!-- doxytag: member="Nps::maxLayer" ref="ae3c83ca224d7cf2ab4e71cafacecfa07" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t <a class="el" href="classNps.html#ae3c83ca224d7cf2ab4e71cafacecfa07">Nps::maxLayer</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00086">86</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, <a class="el" href="Nps_8cc_source.html#l00528">getLandmarks()</a>, <a class="el" href="Nps_8cc_source.html#l00041">init()</a>, <a class="el" href="Nps_8cc_source.html#l00422">sendCoordRequests()</a>, and <a class="el" href="Nps_8cc_source.html#l00460">setOwnLayer()</a>.</p>

</div>
</div>
<a class="anchor" id="a2cd883a94c549eac0ba4dfd7d3939b8e"></a><!-- doxytag: member="Nps::neighborCache" ref="a2cd883a94c549eac0ba4dfd7d3939b8e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classNeighborCache.html">NeighborCache</a>* <a class="el" href="classNps.html#a2cd883a94c549eac0ba4dfd7d3939b8e">Nps::neighborCache</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00081">81</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00160">coordsReqRpc()</a>, <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, <a class="el" href="Nps_8cc_source.html#l00073">handleTimerEvent()</a>, <a class="el" href="Nps_8cc_source.html#l00438">sendCoordsReqCall()</a>, <a class="el" href="Nps_8cc_source.html#l00392">setLandmarkSet()</a>, and <a class="el" href="Nps_8cc_source.html#l00460">setOwnLayer()</a>.</p>

</div>
</div>
<a class="anchor" id="aafd08b151389f68f9e74c9131ba302f1"></a><!-- doxytag: member="Nps::nodeMeasurements" ref="aafd08b151389f68f9e74c9131ba302f1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="structRttMeasurement.html">RttMeasurement</a>&gt; <a class="el" href="classNps.html#aafd08b151389f68f9e74c9131ba302f1">Nps::nodeMeasurements</a><code> [protected]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00178">178</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00616">deleteNodeMeasurement()</a>, and <a class="el" href="Nps_8cc_source.html#l00585">updateNodeMeasurement()</a>.</p>

</div>
</div>
<a class="anchor" id="a2fa1935935077a421a76979a613e4517"></a><!-- doxytag: member="Nps::overlay" ref="a2fa1935935077a421a76979a613e4517" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classBaseOverlay.html">BaseOverlay</a>* <a class="el" href="classNps.html#a2fa1935935077a421a76979a613e4517">Nps::overlay</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00082">82</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00041">init()</a>.</p>

</div>
</div>
<a class="anchor" id="a7ed2ce6106d9941ae86d47a26e08dad5"></a><!-- doxytag: member="Nps::ownCoords" ref="a7ed2ce6106d9941ae86d47a26e08dad5" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classGnpNpsCoordsInfo.html">GnpNpsCoordsInfo</a>* <a class="el" href="classNps.html#a7ed2ce6106d9941ae86d47a26e08dad5">Nps::ownCoords</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00090">90</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00561">getCoordinateBasedProx()</a>, <a class="el" href="Nps_8h_source.html#l00113">getOwnCoordinates()</a>, <a class="el" href="Nps_8h_source.html#l00115">getOwnLayer()</a>, <a class="el" href="Nps_8h_source.html#l00111">getOwnNcsInfo()</a>, <a class="el" href="Nps_8cc_source.html#l00041">init()</a>, <a class="el" href="Nps_8h_source.html#l00132">setOwnCoordinates()</a>, and <a class="el" href="Nps_8cc_source.html#l00460">setOwnLayer()</a>.</p>

</div>
</div>
<a class="anchor" id="ac09a03018ddd419b62867c516974090a"></a><!-- doxytag: member="Nps::pendingRequests" ref="ac09a03018ddd419b62867c516974090a" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int16_t <a class="el" href="classNps.html#ac09a03018ddd419b62867c516974090a">Nps::pendingRequests</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00092">92</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00207">coordsReqRpcResponse()</a>, <a class="el" href="Nps_8cc_source.html#l00106">handleRpcTimeout()</a>, <a class="el" href="Nps_8cc_source.html#l00041">init()</a>, and <a class="el" href="Nps_8cc_source.html#l00438">sendCoordsReqCall()</a>.</p>

</div>
</div>
<a class="anchor" id="a2ac887be6d5f1333cefc902be95ddfa7"></a><!-- doxytag: member="Nps::receivedCalls" ref="a2ac887be6d5f1333cefc902be95ddfa7" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t <a class="el" href="classNps.html#a2ac887be6d5f1333cefc902be95ddfa7">Nps::receivedCalls</a><code> [private]</code></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="Nps_8h_source.html#l00097">97</a> of file <a class="el" href="Nps_8h_source.html">Nps.h</a>.</p>

<p>Referenced by <a class="el" href="Nps_8cc_source.html#l00160">coordsReqRpc()</a>, <a class="el" href="Nps_8h_source.html#l00187">getReceivedCalls()</a>, and <a class="el" href="Nps_8cc_source.html#l00041">init()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li><a class="el" href="Nps_8h_source.html">Nps.h</a></li>
<li><a class="el" href="Nps_8cc_source.html">Nps.cc</a></li>
</ul>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Wed Nov 3 2010 14:40:52 for OverSim by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
